<html>
<head>
<title>Octopus Deploy Config as Code: early access preview - Octopus Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Octopus部署配置代码:早期访问预览- Octopus部署</h1>
<blockquote>原文：<a href="https://octopus.com/blog/config-as-code-eap#2022-05-06">https://octopus.com/blog/config-as-code-eap#2022-05-06</a></blockquote>
                        <p>我们的代码早期访问预览(EAP)配置现在可用。</p>

<p>Octopus中的configuration as Code(Config as Code)提供了Git的全部功能和Octopus的可用性。除了现有的数据库实现，我们还构建了一个健壮的Git-persistent层。这意味着您可以在应用程序代码旁边的Git repo中看到您的部署过程，并一起发展它们。</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-12/config-as-code-eap/blogimage-config-as-code-explanation_2021.gif" class="zoom" data-title=""><img src="../Images/1175c08e3e8d2d7ae4261c8efb21783d.png" class="img-fluid center" alt="Octopus Configuration as Code - Early Access Preview" data-original-src="https://i.octopus.com/blog/2021-12/config-as-code-eap/blogimage-config-as-code-explanation_2021.gif"/>T2】</a></p>

<p>我们的配置代码解决方案允许您:</p>

<ul>
<li>通过分支支持部署流程的多个版本</li>
<li>将对部署流程的更改与拉请求合并</li>
<li>查看部署流程的更改历史，包括谁在何时执行了更改</li>
<li>恢复到先前版本的部署流程</li>
</ul>

<p>重要的是，Octopus UI仍然有效，因此您不需要学习一种全新的语言来编辑您的流程。但是，如果您愿意，您仍然可以使用您最喜欢的文本编辑器来编辑您的配置。</p>

<p>在这篇文章中，我将介绍我们的Config as Code解决方案，并解释如何开始。</p>

<p>Octopus中的Config as代码是一个早期的访问预览，所以可能会有一些粗糙的边缘。我们建议创建新的项目或克隆现有的项目来进行试验，而不是在生产中进行测试。</p>
<p>由于我们仍在开发这一功能，我们非常感谢<a href="https://octopusdeploy.typeform.com/to/qeW9JGyo" class="alert-link" rel="nofollow">您愿意分享的任何反馈</a>。我们还建议在<code>#config-as-code</code>频道的<a href="https://octopus.com/slack" class="alert-link">社区Slack </a>中加入讨论。</p>


<h2 id="why-configuration-as-code">为什么将配置作为代码？</h2>

<p>许多现代IT和DevOps系统提供“as code”实现。常见的例子是基础设施即代码(IaC)解决方案，如HashiCorp的<a href="https://terraform.io" rel="nofollow"> Terraform </a>和<a href="https://pulumi.com" rel="nofollow"> Pulumi </a>到CI服务器，如<a href="https://www.jenkins.io/" rel="nofollow"> Jenkins </a>和<a href="https://www.jetbrains.com/teamcity/" rel="nofollow"> TeamCity </a>，它们允许您将构建配置指定为代码。</p>

<p>这些解决方案将纯文本代码/配置细节存储在源代码存储库中。这允许您发展您的系统配置并享受Git的好处，包括分支和历史。</p>

<p>在Octopus <a href="https://octopusdeploy.uservoice.com/" rel="nofollow"> UserVoice网站</a>上，以及在会议和活动中，Config As Code一直是我们的客户提出的<a href="https://octopusdeploy.uservoice.com/forums/170787-general/suggestions/15698781-version-control-configuration" rel="nofollow">最高</a> <a href="https://octopusdeploy.uservoice.com/forums/170787-general/suggestions/32541541-deployment-pipeline-as-code" rel="nofollow">要求</a>之一。</p>

<p>我们使用您的反馈来指导我们的“配置为代码”解决方案的构建。</p>

<h2 id="octopus-config-as-code-the-best-of-both-worlds">Octopus配置代码-两全其美</h2>

<p>当为项目启用Config as Code时，您可以像往常一样继续使用Octopus UI，或者可以在您喜欢的编辑器中编辑文本文件。你可以在效率最高的地方工作。</p>

<p>我们的配置文件格式是章鱼配置语言(OCL)，基于<a href="https://github.com/hashicorp/hcl" rel="nofollow"> HashiCorp的HCL </a>。我们希望我们的配置文件是人类可读的，并支持复杂的文档，如部署和操作手册流程。我们喜欢HCL，并认为它是这项工作的正确工具，但我们已经编写了自己的<a href="https://github.com/OctopusDeploy/Ocl" rel="nofollow">解析器/串行化器</a>。这意味着我们没有义务遵循哈希公司的任何方向，也没有什么可以阻止我们做出改变。</p>

<p>参见Michael Richardson关于<a href="https://octopus.com/blog/shaping-config-as-code">将配置塑造成代码</a>的帖子，了解更多关于将配置塑造成代码解决方案的因素。</p>

<h3 id="all-the-power-of-git">Git的所有功能</h3>

<p>分支是Git的超能力，我们想要展示这种能力。您可以在Octopus UI中切换分支(并很快创建它们)，允许您对分支上的部署过程进行更改。这实际上允许一个草稿模式，因为您可以从您的分支中创建一个发布并测试您的变更。当与Git提供者的特性结合起来时，比如pull请求、受保护的分支和代码所有者，这可以实现一组全新的工作流。</p>

<p>保存对部署流程的更改时，可以添加提交消息。您还可以在没有消息的情况下提交更改(这是默认设置)，这在迭代以使复杂的部署过程工作时非常方便。</p>

<h3 id="the-octopus-ui-still-works">Octopus用户界面仍然有效</h3>

<p>我们希望你有一个伟大的配置代码使用八达通门户网站的经验。您可以配置您的Git存储库、选择您的分支、提交更改等等，所有这些都可以从Octopus用户界面中完成。</p>

<p>如果您喜欢完全控制，您可以编辑底层配置文件，但这不是必需的。丰富的双向同步意味着您可以混合搭配使用web UI和直接编辑。</p>

<h3 id="edit-your-configuration-with-visual-studio-code">使用Visual Studio代码编辑配置</h3>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-12/config-as-code-eap/octopus-deploy-vs-code-extension-ocl.png" class="zoom" data-title=""><img src="../Images/e62f965d05e0d86f843032978da7f5c7.png" class="img-fluid center" alt="The VS Code extension for Octopus includes OCL syntax highlighting and an OCL tree outline" data-original-src="https://i.octopus.com/blog/2021-12/config-as-code-eap/octopus-deploy-vs-code-extension-ocl.png"/></a>T2】</p>

<p>有些人喜欢web界面，而有些人喜欢在他们喜欢的文本编辑器中编辑文本文件。为了使与OCL的合作更容易，我们为Visual Studio代码构建了一个<a href="https://marketplace.visualstudio.com/items?itemName=octopusdeploy.vscode-octopusdeploy" rel="nofollow"> Octopus Deploy扩展来补充Octopus UI。</a></p>

<p>OCL的编辑经验包括:</p>

<ul>
<li>语法突出显示</li>
<li>步骤和操作的代码片段</li>
<li>在文件中导航节点的集成树视图</li>
</ul>

<p>我们的VS代码扩展也是一个早期访问预览版，但是我们迭代得很快。我们建议安装并试用它。</p>

<h3 id="convert-your-existing-projects">转换现有项目</h3>

<p>可以在现有项目上启用“配置为代码”。这意味着您不需要创建一个新项目并重新开始。大多数Octopus特性与Config as代码完全兼容(例外情况见我们的<a href="https://octopus.com/docs/projects/version-control">文档</a>)。</p>

<p>注意:这是一个单向过程，您无法将项目恢复为存储在数据库中。鉴于这是早期access预览版，我们建议您在测试此功能时克隆现有项目或导出它们。</p>


<h2 id="what-processes-are-version-controlled">什么过程是受版本控制的？</h2>

<p>对于这个第一版，只有部署过程是受版本控制的(还有一些与部署过程密切相关的设置)。</p>

<p>我们打算将操作手册和变量作为以下工作来实现。</p>

<h2 id="getting-started-with-config-as-code">以代码形式配置入门</h2>

<p>要开始使用Octopus中的Config as Code EAP，您需要启用特性标志。</p>

<p>导航至<strong>配置</strong>，然后<strong>功能</strong>，并开启该功能。</p>

<p>由于这是早期的access预览，请记住创建新项目或克隆现有项目来测试它。</p>


<p>或者，您可以在我们的网上技术交流讲座<a href="https://octopus.com/events/technical-deep-dive-with-config-as-code">以代码</a>的形式深入了解配置中看到配置代码。</p>

<iframe src="https://www.youtube.com/embed/oZfxlbpSP14" frameborder="0" allowfullscreen="">VIDEO</iframe>

<h3 id="configuring-your-git-repository">配置您的Git存储库</h3>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-12/config-as-code-eap/cac-settings.png" class="zoom" data-title=""><img src="../Images/27b0ad195f9139d1e4781b84756a91d4.png" class="img-fluid center" alt="Octopus Config as Code settings" data-original-src="https://i.octopus.com/blog/2021-12/config-as-code-eap/cac-settings.png"/>T2】</a></p>

<p>导航到<strong>设置</strong>然后<strong>版本控制</strong>来指定您的Git存储库细节。</p>

<p>在上面的例子中，我选择了一个公共存储库，并输入了我的GitHub用户名和一个个人访问令牌。</p>

<h3 id="selecting-a-branch-and-committing-changes">选择一个分支并提交更改</h3>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-12/config-as-code-eap/cac-branch-selector.png" class="zoom" data-title=""><img src="../Images/d188748ebb2aa259c5b5a7a6c4175eec.png" class="img-fluid center" alt="Octopus Config as Code branch selector" data-original-src="https://i.octopus.com/blog/2021-12/config-as-code-eap/cac-branch-selector.png"/></a>T2】</p>

<p>部署流程编辑器最明显的变化是我们新的分支选择器。</p>

<p>要开始使用:</p>

<ol>
<li>给你的回购推一个新的分支</li>
<li>对您的部署过程进行更改(例如，添加一个新的<strong> Hello world！</strong>脚本步骤)</li>
<li>提交带有描述的更改</li>
<li>导航到您的Git repo并检查更改</li>
</ol>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-12/config-as-code-eap/cac-commit-desc.png" class="zoom" data-title=""><img src="../Images/c38ef06a9406f05b2dd71d4df95295d9.png" class="img-fluid center" alt="Octopus Config as Code commit description" data-original-src="https://i.octopus.com/blog/2021-12/config-as-code-eap/cac-commit-desc.png"/>T2】</a></p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-12/config-as-code-eap/cac-commit-diff.png" class="zoom" data-title=""><img src="../Images/7e014146ae3764c547c97e6a1c2d2427.png" class="img-fluid center" alt="Octopus Config as Code pull request diff" data-original-src="https://i.octopus.com/blog/2021-12/config-as-code-eap/cac-commit-diff.png"/>T2】</a></p>

<h3 id="creating-a-release">创建版本</h3>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-12/config-as-code-eap/cac-create-release.png" class="zoom" data-title=""><img src="../Images/00f544146a947bc0949bacd947c2d34f.png" class="img-fluid center" alt="Octopus Config as Code: release creation" data-original-src="https://i.octopus.com/blog/2021-12/config-as-code-eap/cac-create-release.png"/>T2】</a></p>

<p>创建发布时，选择包含您的部署过程的分支。Octopus会自动选择所选分支的负责人。您的部署一如既往地以同样可重复且可靠的方式执行。</p>

<h2 id="conclusion">结论</h2>

<p>我们的配置代码早期访问预览现在可用。它提供了Git的强大功能和人类可读的文本格式，与Octopus的可用性相平衡。</p>

<p>这只是该功能的第一步。我们有一个即将推出的功能路线图，我们希望您能帮助指导我们。</p>

<p>我们希望您能尝试将Config as Code用于您的工作流程，并<a href="https://octopusdeploy.typeform.com/to/qeW9JGyo" rel="nofollow">让我们知道如何改进它</a>。</p>

<h2 id="watch-our-webinar-introducing-config-as-code-in-octopus">观看我们的网络研讨会:在Octopus中将配置作为代码引入</h2>

<p>德里克·坎贝尔和皮特·加拉格尔将带你了解在Octopus中配置为代码的入门知识，以及在大规模使用配置为代码时的最佳实践。</p>

<iframe src="https://www.youtube.com/embed/Z4DgiJ630FU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">VIDEO</iframe>

<p>我们定期举办网络研讨会。请参见<a href="https://octopus.com/events">网络研讨会第</a>页，了解有关即将举行的活动和实时流媒体录制的详细信息。</p>

<p>愉快的(版本控制的)部署！</p>

                    
                    
</body>
</html>