# 传统运行手册与 Octopus 运行手册- Octopus 部署

> 原文：<https://octopus.com/blog/traditional-runbooks-vs-octopus-runbooks>

我们谈论了很多关于 Octopus 如何能够[完成您的持续集成和持续部署(CI/CD)管道](https://octopus.com/blog/how-octopus-complements-build-server)，但是您知道 Octopus Deploy 的 Runbooks 功能也可以帮助您完成运营任务吗？

在这篇文章中，我们探索了作为 DevOps 一部分的 Octopus Runbooks 的好处，它们解决的问题，以及如何设置它们。

## 什么是 runbook？

简而言之，操作手册是完成常规或紧急计算机程序的一步一步的指南。

在过去的 IT 运营中，团队将这些指南整理成实体书籍或文件夹，仅在需要时才从书架上取下。如今，它们通常存在于共享网络驱动器、维基或知识库的文档中。

例如，假设一个应用服务器有一个由偶尔挂起的 Windows 服务引起的已知问题。支持团队可能有一本操作手册(或知识文章)来指导支持成员重新启动该服务。其他典型的操作手册包括:

*   数据库备份和恢复
*   服务器维护，如升级、修补或文件整理
*   服务器、服务或 web 应用程序重新启动
*   决策树的故障诊断步骤

无论是物理的还是其他的，手动操作手册都有一些问题，因为它们可能是:

*   耗时——手动完成指南和分支步骤需要时间，对于那些不熟悉系统的人来说更是如此。
*   容易出现人为错误——即使是最简单的指令，我们中最优秀的人也会犯错误。毕竟 pobody 的 nerfect！
*   过时——在繁忙的团队中，内部文档的维护经常会降低优先级。这使得操作手册过时或缺乏一致性。
*   难以管理的访问——您的运营团队可能需要访问无数的系统。风险自然会随着能接触到某样东西的人数的增加而增加，或者一个人接触到的东西越多。但是，您也不希望支持成员在真正需要时发现他们没有访问权限。

如果使用 Octopus Deploy，这些都是可以避免的问题。

## 八达通手册的好处

让我们来看看 Octopus 如何帮助解决传统 runbooks 的问题，以及其他一些好处。

### 运行手册自动化

作为一个产品，我们开发 Octopus 是因为我们相信可重复的部署意味着健壮的部署。章鱼手册遵循同样的信念。

这降低了人为错误的风险，并加快了流程。只需设置您的步骤一次，并触发一个点击操作手册。

### 章鱼手册已经了解你的环境

如果您是客户，您的 Octopus 实例已经连接到您部署的基础设施。您在 Octopus 中创建的任何 runbooks 也使用这些集成，因此没有什么新的操作任务需要设置。

Octopus 操作手册也不依赖于您环境的部署生命周期。您可以在需要时针对任何环境或部署目标运行它们。

### Octopus Runbooks 有助于安全和节省网络管理

在我们之前的示例中，当支持人员需要在 Windows 服务器上重新启动服务时，您需要通过以下方式之一授予他们访问服务器的权限:

*   权限组
*   共享网络帐户
*   本地管理员权限

如果同一个支持团队负责许多系统(在运营中就是这种情况)，那么弄清楚他们拥有或需要访问什么可能会令人困惑。

鉴于 Octopus 已经连接到您的部署目标，我们的操作手册意味着您不需要为操作任务分配对基础架构的直接访问。因此，如果随叫随到的支持人员需要重启某些东西，他们只需要访问 Octopus 和操作手册。章鱼管理其余的。

### 八达通有详细的审计跟踪

Octopus 还提供每个触发的运行手册的完整审计日志，因此您可以随时看到:

*   谁做了什么，什么时候，为什么
*   操作手册的成功和失败——知道什么时候以及为什么是时候更新你的操作手册了
*   事故响应报告所需的信息

### 如果您可以创建一个部署流程，那么您可以创建一个操作手册

创建部署和操作手册的过程是相似的。通过这两种方式，您可以使用预定义操作的组合或您喜欢的任何脚本语言来设置步骤。

让我们通过一个简单的操作手册来完成创建过程。

## 用 Octopus 创建一个简单的操作手册

这个例子向您展示了如何创建一个基本的 runbook，它不会影响您的任何项目或环境。如果你是现有用户，你可以跟进，或者通过[注册免费试用](https://octopus.com/start)。

如果您不想跟随，但仍然想看到最终结果，我们用这个 runbook 设置了一个[示例实例，可供来宾访问。](https://tenpillars.octopus.app/app#/Spaces-82/projects/starter-runbooks/operations/runbooks/Runbooks-181/process/RunbookProcess-Runbooks-181)

本指南假设您已经:

本操作手册将:

*   运行“Hello World”脚本
*   当 runbook 成功完成时，通知松弛通道

请遵循以下步骤:

1.  打开并登录 Octopus。
2.  点击**项目**，从列表中选择一个已有的项目。
3.  从左侧菜单中点击**操作**。
4.  点击**进入运行手册**。
5.  点击**添加运行手册**。
6.  给你的新 runbook 起一个合适的名字和描述，然后点击**保存**。
7.  点击**定义您的 RUNBOOK 流程**。
8.  点击**添加步骤**。
9.  选择**脚本**，悬停在**上，从结果中运行脚本**，点击**添加**。
10.  更改以下设置，保留其他所有设置为默认设置，并点击**保存**:
    *   **步骤名称** -给步骤起一个描述性的名称。
    *   **执行位置**——根据你的 Octopus 设置，选择**在 Octopus 服务器**上运行或者**在 worker** 上运行一次。
    *   **内联源代码**——选择 **PowerShell** 单选按钮，并在代码框中输入以下内容:`Write-Host 'Hello, World!'`
11.  现在，您可以添加在 runbook 成功完成时向 Slack 发送消息的步骤。再次点击**添加步骤**。
12.  搜索`slack`，悬停在 **Slack -从结果中发送简单通知**并点击**添加**。如果提示将步骤保存到实例的模板中，单击**保存**。
13.  完成以下设置，保留其他所有设置为默认，并点击**保存**:
    *   **步骤名称** -给步骤起一个描述性的名称。
    *   **执行位置** -根据您的 Octopus 设置，选择**在 Octopus 服务器上运行**或**在 worker** 上运行一次。
    *   **Hook URL** -复制你的 Slack Webhook URL。如果其他人可以看到你的 Octopus 实例或者你正在创建一个真正的 runbook，考虑把你的 webhook 作为一个[项目变量](https://octopus.com/docs/projects/variables)添加进来。然后，您可以使用下面的语法`#{variable-name}`安全地调用 webhook。
    *   **频道句柄** -输入您想要发布消息的确切空闲频道。
    *   **消息** -输入你希望 Octopus 发送给 Slack 的成功消息。
14.  点击**运行...**测试运行手册。根据您的 Octopus 设置，您可能需要选择环境。如果是，选择任何环境(这并不重要，因为这个 runbook 不会改变任何东西)并再次点击**运行**。
15.  等待运行手册完成，并检查您之前设置的消息的剩余时间。

当创建一本真正的 runbook 时，你必须点击**发布**以使它对其他团队成员和 Octopus 触发事件可用。

## 下一步是什么？

这只是一个尝试者，向你展示 Octopus Runbooks 的好处以及设置它们是多么容易。

在[即将发布的系列文章](https://octopus.com/blog/tag/Runbooks%20Series)中，我们将带您浏览一些真实的用例，包括如何使用 Octopus Runbooks:

*   应对漏洞
*   创建标准化的支持电子邮件
*   对您的基础设施进行冒烟测试
*   通过实例调度管理云成本
*   管理影子 IT 资源
*   计算 DORA 指标
*   用 Bash 脚本设置 Linux 服务器

同时，参见我们的 [Octopus Runbook 文档](https://octopus.com/docs/runbooks/runbook-examples)获取更多的例子。

阅读我们的 [Runbooks 系列](https://octopus.com/blog/tag/Runbooks%20Series)的其余部分。

愉快的部署！