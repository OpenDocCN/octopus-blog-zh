<html>
<head>
<title>Octopus Tentacle on ARM/ARM64 - Octopus Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>æ‰‹è‡‚ä¸Šçš„ç« é±¼è§¦æ‰‹/æ‰‹è‡‚64 -ç« é±¼å±•å¼€</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://octopus.com/blog/tentacle-on-arm#2021-10-14">https://octopus.com/blog/tentacle-on-arm#2021-10-14</a></blockquote>
                        <p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-01/tentacle-on-arm/blogimage-raspberrypi.png" class="zoom" data-title=""><img src="../Images/c2cfdf5d4432296fbf87c2f5d8217acc.png" class="img-fluid center" alt="Octopus Tentacle on ARM/ARM64" data-original-src="https://i.octopus.com/blog/2021-01/tentacle-on-arm/blogimage-raspberrypi.png"/>T2ã€‘</a></p>

<p>æˆ‘ä»¬å¾ˆé«˜å…´åœ°åˆ†äº«æˆ‘ä»¬çš„è§¦æ‰‹ä»£ç†ç°åœ¨æ”¯æŒARMå’ŒARM64ç¡¬ä»¶ã€‚è¿™ä¸€æ›´æ–°ä½¿æ‚¨å¯ä»¥å°†åº”ç”¨å’ŒæœåŠ¡éƒ¨ç½²åˆ°Raspberry Pi 3 &amp; 4ã€AWS A1 EC2å®ä¾‹æˆ–ä»»ä½•å¯ä»¥è¿è¡Œ<a href="https://devblogs.microsoft.com/dotnet/announcing-net-core-3-0/#platform-support" rel="nofollow">çš„ARMç¡¬ä»¶ã€‚ç½‘èŠ¯3.0æˆ–æ›´é«˜ç‰ˆæœ¬</a>ã€‚</p>

<p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è§£é‡Šä¸ºä»€ä¹ˆåœ¨ARMæœåŠ¡å™¨ä¸Šè¿è¡Œè§¦æ‰‹æ˜¯æœ‰ä»·å€¼çš„ï¼Œä»¥åŠå¦‚ä½•å¼€å§‹ã€‚</p>

<h2 id="why-tentacle-on-armarm64">ä¸ºä»€ä¹ˆè§¦æ‰‹åœ¨ARM/ARM64ä¸Šï¼Ÿ</h2>

<p>æ—©åœ¨2019å¹´æœ«ï¼Œæˆ‘ä»¬å°±æ¨å‡ºäº†å¯¹åŸºäºARMçš„éƒ¨ç½²ç›®æ ‡å’Œå·¥ä½œäººå‘˜çš„æ”¯æŒï¼Œä½œä¸ºSSHè¿æ¥é€‰é¡¹*ã€‚<a href="https://octopus.com/downloads/tentacle#linux"> Linuxè§¦æ‰‹</a>å·²ç»å‡ºç°äº†ä¸€æ®µæ—¶é—´ï¼Œä½†æ˜¯å®ƒåªæ”¯æŒåŸºäº<code>x86_64/amd64</code>çš„æœºå™¨ï¼Œä½¿å¾—ARMé‡‡ç”¨è€…åªèƒ½ä½¿ç”¨SSHã€‚</p>

<p>é€šè¿‡SSHè¿æ¥æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å®ƒå¹¶ä¸é€‚ç”¨äºæ¯ä¸ªäººï¼Œæ¯”å¦‚ä¸å…è®¸ä½¿ç”¨ç«¯å£22çš„é«˜åº¦å®‰å…¨çš„ç¯å¢ƒã€‚å®ƒè¿˜éœ€è¦åœ¨OctopusæœåŠ¡å™¨å’ŒSSHæœåŠ¡å™¨ä¹‹é—´å»ºç«‹ç›´æ¥è¿æ¥ï¼Œå¯èƒ½éœ€è¦é€šè¿‡é˜²ç«å¢™ã€‚</p>

<p>é€šè¿‡åœ¨ARMè®¾å¤‡ä¸Šå®‰è£…è½®è¯¢è§¦æ‰‹ï¼Œå¯ä»¥é¿å…ä¸ºSSHè¿æ¥æ‰“å¼€é˜²ç«å¢™ç«¯å£ï¼Œå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯Octopusäº‘æœåŠ¡ï¼Œè¿™ä¸€ç‚¹å°¤ä¸ºé‡è¦ã€‚</p>

<p>è¯·éšæ„æŸ¥çœ‹æˆ‘ä»¬çš„<a href="https://octopus.com/blog/tentacle-on-linux">å‰ä¸€ç¯‡åšæ–‡</a>ï¼Œè¿™ç¯‡åšæ–‡æ›´è¯¦ç»†åœ°ä»‹ç»äº†ä½¿ç”¨Linuxè§¦æ‰‹è¿›è¡Œéƒ¨ç½²è€Œä¸æ˜¯SSHçš„å¥½å¤„ã€‚</p>

<p>åœ¨ARMç¡¬ä»¶ä¸Šè¿è¡Œæ‚¨çš„å·¥ä½œè´Ÿè½½æœ‰ä¸€äº›å¥½å¤„:</p>

<ul>
<li>é™ä½è¿è¡Œæˆæœ¬</li>
<li>å¯¹äºRaspberry Piç­‰å°å‹åˆ¶é€ å•†è€Œè¨€ï¼Œæ˜¯ä½æˆæœ¬å¯æ›´æ¢å•å…ƒã€‚</li>
<li>ä¸x86æœåŠ¡å™¨ç›¸æ¯”ï¼Œè®¡ç®—é€Ÿåº¦æ›´å¿«ã€‚</li>
</ul>

<p><a href="https://www.section.io/engineering-education/arm-x86/" rel="nofollow">ARMä¸x86çš„æ¯”è¾ƒ</a></p>

<p>* <em>ä»æŠ€æœ¯ä¸Šæ¥è¯´ï¼Œå®ƒæ¯”è¿™ä¸ªæ—¶é—´æ›´æ—©ï¼Œä½†ä½ å¿…é¡»è·¨è¶Šä¸€äº›å°´å°¬çš„éšœç¢ã€‚</em></p>

<h2 id="getting-started">å…¥é—¨æŒ‡å—</h2>

<p>åœ¨Linuxä¸Šé…ç½®è§¦æ‰‹çš„æ‰€æœ‰è¯´æ˜éƒ½å¯ä»¥åœ¨æˆ‘ä»¬çš„<a href="https://octopus.com/docs/infrastructure/deployment-targets/linux/tentacle">æ–‡æ¡£</a>ä¸­æ‰¾åˆ°ï¼Œä½†æ˜¯æˆ‘å°†æä¾›ä¸€ä¸ªæ­¥éª¤çš„æ¼”ç¤ºã€‚åœ¨æ¼”ç»ƒçš„æœ€åï¼Œæˆ‘ä»¬å°†åœ¨ç§æœ‰ç½‘ç»œä¸­æœ‰ä¸€ä¸ªRaspberry Piï¼Œå®ƒè¿æ¥åˆ°ä¸€ä¸ªOctopus Cloudå®ä¾‹ã€‚</p>

<p>å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘åœ¨<a href="https://www.raspberrypi.org/products/" rel="nofollow">æ ‘è“æ´¾3B+ </a>ä¸Šè¿è¡Œ<a href="https://getfedora.org/en/server/download/" rel="nofollow"> Fedora 33æœåŠ¡å™¨</a>ï¼Œå¹¶æ³¨å†Œäº†<a href="https://octopus.com/start/cloud">ç« é±¼äº‘å®ä¾‹</a>ã€‚</p>

<p>æ‚¨è¿˜å¯ä»¥åœ¨è£…æœ‰Ubuntu 18.04æˆ–æ›´é«˜ç‰ˆæœ¬çš„Raspberry Piæˆ–Raspbian Busterä¸Šè¿è¡ŒLinuxè§¦æ‰‹ä»£ç†ã€‚</p>


<p>åœ¨æˆ‘ä»¬å®‰è£…è§¦æ‰‹åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œæ‚¨éœ€è¦ä¸€ä¸ªç”¨äºè®¤è¯çš„<strong> OctopusæœåŠ¡å™¨URL </strong>å’Œä¸€ä¸ª<strong> APIå¯†é’¥</strong>ã€‚å¦‚æœæ‚¨ä½¿ç”¨æœ¬åœ°OctopusæœåŠ¡å™¨å®ä¾‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<strong>ç”¨æˆ·å/å¯†ç </strong>è¿›è¡Œè®¤è¯ã€‚</p>

<h3 id="installation">è£…ç½®</h3>

<p>å®‰è£…è§¦æ‰‹åŒ…å¾ˆç®€å•:</p>

<pre><code class="language-bash">sudo wget https://rpm.octopus.com/tentacle.repo -O /etc/yum.repos.d/tentacle.repo
sudo yum install tentacle
</code></pre>

<p>å®‰è£…ç»“æŸæ—¶ï¼Œæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹æ¶ˆæ¯:</p>

<pre><code>To set up a Tentacle instance, run the following script:
    /opt/octopus/tentacle/configure-tentacle.sh
</code></pre>

<p>å¦‚æœæ‚¨éœ€è¦è¿›è¡Œè‡ªåŠ¨åŒ–çš„ã€å¯é‡å¤çš„å®‰è£…ï¼Œå¯ä»¥åœ¨<a href="https://octopus.com/docs/infrastructure/deployment-targets/linux/tentacle"> Linuxè§¦æ‰‹æ–‡æ¡£</a>ä¸­æ‰¾åˆ°ç¤ºä¾‹è„šæœ¬ï¼Œä½†æ˜¯ç°åœ¨ï¼Œæˆ‘ä»¬å°†è¿è¡Œé…ç½®è„šæœ¬ï¼Œå¹¶ä¸”å¤§éƒ¨åˆ†æƒ…å†µä¸‹åªæ¥å—é»˜è®¤å€¼ã€‚</p>

<p>å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œä¸ºè§¦æ‰‹çš„ç§ç±»é€‰æ‹©<strong>è½®è¯¢</strong> (2)æ˜¯å¾ˆé‡è¦çš„ã€‚<a href="https://octopus.com/docs/infrastructure/deployment-targets/windows-targets/tentacle-communication#polling-tentacles">è½®è¯¢è§¦æ‰‹</a>å°†è¿æ¥åˆ°OctopusæœåŠ¡å™¨ï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦åœ¨é˜²ç«å¢™ä¸­æ‰“å¼€ä»»ä½•é¢å¤–çš„ç«¯å£:</p>

<pre><code class="language-bash">[user@fedora ~]# sudo /opt/octopus/tentacle/configure-tentacle.sh

Name of Tentacle instance (default Tentacle):
Invalid characters will be ignored, the instance name will be: 'Tentacle'

What kind of Tentacle would you like to configure: 1) Listening or 2) Polling (default 1): 2
Where would you like Tentacle to store log files? (/etc/octopus):
Where would you like Tentacle to install applications to? (/home/Octopus/Applications):
Octopus Server URL (eg. https://octopus-server): https://***.octopus.app
Select auth method: 1) API-Key or 2) Username and Password (default 1): 1
API-Key: ...
Select type of Tentacle do you want to setup: 1) Deployment Target or 2) Worker (default 1): 1
What Space would you like to register this Tentacle in? (Default):
What name would you like to register this Tentacle with? (fedora): fedorapi
Enter the environments for this Tentacle (comma seperated): test
Enter the roles for this Tentacle (comma seperated): pi

The following configuration commands will be run to configure Tentacle:
sudo /opt/octopus/tentacle/Tentacle create-instance --instance "Tentacle" --config "/etc/octopus/Tentacle/tentacle-Tentacle.config"
sudo /opt/octopus/tentacle/Tentacle new-certificate --instance "Tentacle" --if-blank
sudo /opt/octopus/tentacle/Tentacle configure --instance "Tentacle" --app "/home/Octopus/Applications" --noListen "True" --reset-trust
sudo /opt/octopus/tentacle/Tentacle register-with --instance "Tentacle" --server "https://***.octopus.app" --name "fedorapi" --comms-style "TentacleActive" --server-comms-port "10943" --apiKey "API-XXXXXXXXXXXXXXXXXXXXXXXXXX" --space "Default" --environment "test"  --role "pi"
sudo /opt/octopus/tentacle/Tentacle service --install --start --instance "Tentacle"
Press enter to continue...

Creating empty configuration file: /etc/octopus/Tentacle/tentacle-Tentacle.config
Saving instance: Tentacle
Setting home directory to: /etc/octopus/Tentacle
A new certificate has been generated and installed. Thumbprint:
9B691824225B6A77AB68...
These changes require a restart of the Tentacle.
Removing all trusted Octopus Servers...
Application directory set to: /home/Octopus/Applications
Tentacle will not listen on a port
These changes require a restart of the Tentacle.
Checking connectivity on the server communications port 10943...
Connected successfully
Registering the tentacle with the server at https://***.octopus.app/
Detected automation environment: NoneOrUnknown
Machine registered successfully
These changes require a restart of the Tentacle.
Service installed: Tentacle
Service started: Tentacle

Tentacle instance 'Tentacle' is now installed
</code></pre>

<p>åœ¨è„šæœ¬å®Œæˆé…ç½®è§¦æ‰‹ä¹‹åï¼Œæ‚¨å°†èƒ½å¤Ÿåœ¨å®ä¾‹çš„Deployment Targetsé¡µé¢ä¸­çœ‹åˆ°Linuxè§¦æ‰‹ã€‚</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-01/tentacle-on-arm/deployment-target.png" class="zoom" data-title=""><img src="../Images/a6bf6ad3e450f2aaac06a99c1b4c6d3c.png" class="img-fluid center" alt="Deployment target" data-original-src="https://i.octopus.com/blog/2021-01/tentacle-on-arm/deployment-target.png"/>T2ã€‘</a></p>

<h3 id="the-tentacle-in-action">è§¦æ‰‹åœ¨è¡ŒåŠ¨</h3>

<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å¯¹æˆ‘ä»¬çš„æ–°è§¦é¡»è¿è¡Œä¸€äº›ä¸œè¥¿ã€‚</p>

<p>å¯¹äºè¿™ä¸€æ­¥ï¼Œæˆ‘å°†å»ºç«‹ä¸€ä¸ªæ–°é¡¹ç›®å¹¶é…ç½®ä¸€ä¸ªrunbookæ¥å®‰è£…æœ€æ–°çš„è½¯ä»¶åŒ…æ›´æ–°ã€‚</p>

<p>åœ¨æ‚¨çš„å®ä¾‹ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œæˆ‘å°†æˆ‘çš„é¡¹ç›®ç§°ä¸º<strong> PiğŸ¥§</strong></p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-01/tentacle-on-arm/project.png" class="zoom" data-title=""><img src="../Images/cc2f8140254132cf844d5b2b7c87f4c4.png" class="img-fluid center" alt="New project" data-original-src="https://i.octopus.com/blog/2021-01/tentacle-on-arm/project.png"/>T2ã€‘</a></p>

<p>ç„¶åæˆ‘åˆ›å»ºäº†ä¸€ä¸ªåä¸º<strong>çš„æ–°runbookå‡çº§å®ƒï¼</strong>æ·»åŠ äº†ä¸€ä¸ªè„šæœ¬æ­¥éª¤ï¼ŒåŒ…å«:</p>

<pre><code class="language-bash">sudo yum upgrade -y
</code></pre>

<p>è¯¥æ­¥éª¤è¢«é…ç½®ä¸ºé’ˆå¯¹è§’è‰²<strong> pi </strong>è¿è¡Œbashè„šæœ¬ï¼Œè¯¥è§’è‰²æ˜¯æˆ‘åœ¨å‰é¢çš„é…ç½®è„šæœ¬ä¸­æŒ‡å®šçš„è§’è‰²ã€‚</p>

<p>ã€T2 <img src="../Images/77d4428335ca34bc810cb72866703815.png" class="img-fluid center" alt="Script step" data-original-src="https://i.octopus.com/blog/2021-01/tentacle-on-arm/script-step.png"/></p>

<p>é’ˆå¯¹ä¸€ä¸ªè§’è‰²è¿è¡Œï¼Œæ„å‘³ç€æ‚¨å¯èƒ½æœ‰è®¸å¤šå…·æœ‰ç›¸åŒè§’è‰²çš„ç›®æ ‡ï¼Œæ‰§è¡Œå°†é’ˆå¯¹æ¯ä¸ªç›®æ ‡è¿è¡Œã€‚æ·»åŠ ä¸€ä¸ªè°ƒåº¦è§¦å‘å™¨ï¼Œæ‚¨å°±æœ‰äº†ä¸€ä¸ªçœŸæ­£çš„DevOpsæµç¨‹ã€‚</p>

<p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œè¿™ä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªåœ¨Raspberry Piä¸Šæ›´æ–°PiHole ( <code>pi-hole -up</code>)æˆ–æ¸…ç†Dockerå›¾åƒ(<code>docker images prune --force</code>)çš„æ“ä½œæ‰‹å†Œï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå°†æœ€æ–°ç‰ˆæœ¬çš„å†…éƒ¨Pythonåº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°è¿œç¨‹ç‰©è”ç½‘ç›‘æ§è®¾å¤‡çš„éƒ¨ç½²é¡¹ç›®ã€‚</p>

<h2 id="conclusion">ç»“è®º</h2>

<p>ä½¿ç”¨ARMç¡¬ä»¶çš„åŸå› æœ‰å¾ˆå¤šï¼Œä»æˆæœ¬èŠ‚çº¦åˆ°æ€§èƒ½æˆ–è¿œç¨‹ç‰©è”ç½‘è®¾å¤‡ã€‚èƒ½å¤Ÿé€šè¿‡è§¦æ‰‹å°†å®ƒä»¬è¿æ¥åˆ°Octopuså®ä¾‹å…è®¸æ‚¨å‘å®ƒä»¬éƒ¨ç½²åº”ç”¨ç¨‹åºæ›´æ–°ï¼Œæˆ–è€…ä½¿ç”¨æˆ‘ä»¬çš„<a href="https://octopus.com/docs/runbooks"> Runbooks </a>åŠŸèƒ½æ¥é›†ä¸­ç®¡ç†æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºã€‚è½®è¯¢è§¦æ‰‹çš„é¢å¤–å¥½å¤„æ˜¯é¿å…å¤æ‚çš„é˜²ç«å¢™é…ç½®ï¼Œå¹¶åœ¨å…¬å…±äº’è”ç½‘ä¸Šæš´éœ²SSHç«¯å£ã€‚</p>

                    
                    
</body>
</html>