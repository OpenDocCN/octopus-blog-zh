<html>
<head>
<title>Octopus Tentacle on ARM/ARM64 - Octopus Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>手臂上的章鱼触手/手臂64 -章鱼展开</h1>
<blockquote>原文：<a href="https://octopus.com/blog/tentacle-on-arm#2021-10-14">https://octopus.com/blog/tentacle-on-arm#2021-10-14</a></blockquote>
                        <p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-01/tentacle-on-arm/blogimage-raspberrypi.png" class="zoom" data-title=""><img src="../Images/c2cfdf5d4432296fbf87c2f5d8217acc.png" class="img-fluid center" alt="Octopus Tentacle on ARM/ARM64" data-original-src="https://i.octopus.com/blog/2021-01/tentacle-on-arm/blogimage-raspberrypi.png"/>T2】</a></p>

<p>我们很高兴地分享我们的触手代理现在支持ARM和ARM64硬件。这一更新使您可以将应用和服务部署到Raspberry Pi 3 &amp; 4、AWS A1 EC2实例或任何可以运行<a href="https://devblogs.microsoft.com/dotnet/announcing-net-core-3-0/#platform-support" rel="nofollow">的ARM硬件。网芯3.0或更高版本</a>。</p>

<p>在这篇文章中，我将解释为什么在ARM服务器上运行触手是有价值的，以及如何开始。</p>

<h2 id="why-tentacle-on-armarm64">为什么触手在ARM/ARM64上？</h2>

<p>早在2019年末，我们就推出了对基于ARM的部署目标和工作人员的支持，作为SSH连接选项*。<a href="https://octopus.com/downloads/tentacle#linux"> Linux触手</a>已经出现了一段时间，但是它只支持基于<code>x86_64/amd64</code>的机器，使得ARM采用者只能使用SSH。</p>

<p>通过SSH连接是可以的，但是它并不适用于每个人，比如不允许使用端口22的高度安全的环境。它还需要在Octopus服务器和SSH服务器之间建立直接连接，可能需要通过防火墙。</p>

<p>通过在ARM设备上安装轮询触手，可以避免为SSH连接打开防火墙端口，如果您使用的是Octopus云服务，这一点尤为重要。</p>

<p>请随意查看我们的<a href="https://octopus.com/blog/tentacle-on-linux">前一篇博文</a>，这篇博文更详细地介绍了使用Linux触手进行部署而不是SSH的好处。</p>

<p>在ARM硬件上运行您的工作负载有一些好处:</p>

<ul>
<li>降低运行成本</li>
<li>对于Raspberry Pi等小型制造商而言，是低成本可更换单元。</li>
<li>与x86服务器相比，计算速度更快。</li>
</ul>

<p><a href="https://www.section.io/engineering-education/arm-x86/" rel="nofollow">ARM与x86的比较</a></p>

<p>* <em>从技术上来说，它比这个时间更早，但你必须跨越一些尴尬的障碍。</em></p>

<h2 id="getting-started">入门指南</h2>

<p>在Linux上配置触手的所有说明都可以在我们的<a href="https://octopus.com/docs/infrastructure/deployment-targets/linux/tentacle">文档</a>中找到，但是我将提供一个步骤的演示。在演练的最后，我们将在私有网络中有一个Raspberry Pi，它连接到一个Octopus Cloud实例。</p>

<p>对于这个例子，我在<a href="https://www.raspberrypi.org/products/" rel="nofollow">树莓派3B+ </a>上运行<a href="https://getfedora.org/en/server/download/" rel="nofollow"> Fedora 33服务器</a>，并注册了<a href="https://octopus.com/start/cloud">章鱼云实例</a>。</p>

<p>您还可以在装有Ubuntu 18.04或更高版本的Raspberry Pi或Raspbian Buster上运行Linux触手代理。</p>


<p>在我们安装触手应用程序之前，您需要一个用于认证的<strong> Octopus服务器URL </strong>和一个<strong> API密钥</strong>。如果您使用本地Octopus服务器实例，您可以使用<strong>用户名/密码</strong>进行认证。</p>

<h3 id="installation">装置</h3>

<p>安装触手包很简单:</p>

<pre><code class="language-bash">sudo wget https://rpm.octopus.com/tentacle.repo -O /etc/yum.repos.d/tentacle.repo
sudo yum install tentacle
</code></pre>

<p>安装结束时，您将看到以下消息:</p>

<pre><code>To set up a Tentacle instance, run the following script:
    /opt/octopus/tentacle/configure-tentacle.sh
</code></pre>

<p>如果您需要进行自动化的、可重复的安装，可以在<a href="https://octopus.com/docs/infrastructure/deployment-targets/linux/tentacle"> Linux触手文档</a>中找到示例脚本，但是现在，我们将运行配置脚本，并且大部分情况下只接受默认值。</p>

<p>对于这个例子，为触手的种类选择<strong>轮询</strong> (2)是很重要的。<a href="https://octopus.com/docs/infrastructure/deployment-targets/windows-targets/tentacle-communication#polling-tentacles">轮询触手</a>将连接到Octopus服务器，因此我们不需要在防火墙中打开任何额外的端口:</p>

<pre><code class="language-bash">[user@fedora ~]# sudo /opt/octopus/tentacle/configure-tentacle.sh

Name of Tentacle instance (default Tentacle):
Invalid characters will be ignored, the instance name will be: 'Tentacle'

What kind of Tentacle would you like to configure: 1) Listening or 2) Polling (default 1): 2
Where would you like Tentacle to store log files? (/etc/octopus):
Where would you like Tentacle to install applications to? (/home/Octopus/Applications):
Octopus Server URL (eg. https://octopus-server): https://***.octopus.app
Select auth method: 1) API-Key or 2) Username and Password (default 1): 1
API-Key: ...
Select type of Tentacle do you want to setup: 1) Deployment Target or 2) Worker (default 1): 1
What Space would you like to register this Tentacle in? (Default):
What name would you like to register this Tentacle with? (fedora): fedorapi
Enter the environments for this Tentacle (comma seperated): test
Enter the roles for this Tentacle (comma seperated): pi

The following configuration commands will be run to configure Tentacle:
sudo /opt/octopus/tentacle/Tentacle create-instance --instance "Tentacle" --config "/etc/octopus/Tentacle/tentacle-Tentacle.config"
sudo /opt/octopus/tentacle/Tentacle new-certificate --instance "Tentacle" --if-blank
sudo /opt/octopus/tentacle/Tentacle configure --instance "Tentacle" --app "/home/Octopus/Applications" --noListen "True" --reset-trust
sudo /opt/octopus/tentacle/Tentacle register-with --instance "Tentacle" --server "https://***.octopus.app" --name "fedorapi" --comms-style "TentacleActive" --server-comms-port "10943" --apiKey "API-XXXXXXXXXXXXXXXXXXXXXXXXXX" --space "Default" --environment "test"  --role "pi"
sudo /opt/octopus/tentacle/Tentacle service --install --start --instance "Tentacle"
Press enter to continue...

Creating empty configuration file: /etc/octopus/Tentacle/tentacle-Tentacle.config
Saving instance: Tentacle
Setting home directory to: /etc/octopus/Tentacle
A new certificate has been generated and installed. Thumbprint:
9B691824225B6A77AB68...
These changes require a restart of the Tentacle.
Removing all trusted Octopus Servers...
Application directory set to: /home/Octopus/Applications
Tentacle will not listen on a port
These changes require a restart of the Tentacle.
Checking connectivity on the server communications port 10943...
Connected successfully
Registering the tentacle with the server at https://***.octopus.app/
Detected automation environment: NoneOrUnknown
Machine registered successfully
These changes require a restart of the Tentacle.
Service installed: Tentacle
Service started: Tentacle

Tentacle instance 'Tentacle' is now installed
</code></pre>

<p>在脚本完成配置触手之后，您将能够在实例的Deployment Targets页面中看到Linux触手。</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-01/tentacle-on-arm/deployment-target.png" class="zoom" data-title=""><img src="../Images/a6bf6ad3e450f2aaac06a99c1b4c6d3c.png" class="img-fluid center" alt="Deployment target" data-original-src="https://i.octopus.com/blog/2021-01/tentacle-on-arm/deployment-target.png"/>T2】</a></p>

<h3 id="the-tentacle-in-action">触手在行动</h3>

<p>接下来，我们将对我们的新触须运行一些东西。</p>

<p>对于这一步，我将建立一个新项目并配置一个runbook来安装最新的软件包更新。</p>

<p>在您的实例中，创建一个新项目，我将我的项目称为<strong> Pi🥧</strong></p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-01/tentacle-on-arm/project.png" class="zoom" data-title=""><img src="../Images/cc2f8140254132cf844d5b2b7c87f4c4.png" class="img-fluid center" alt="New project" data-original-src="https://i.octopus.com/blog/2021-01/tentacle-on-arm/project.png"/>T2】</a></p>

<p>然后我创建了一个名为<strong>的新runbook升级它！</strong>添加了一个脚本步骤，包含:</p>

<pre><code class="language-bash">sudo yum upgrade -y
</code></pre>

<p>该步骤被配置为针对角色<strong> pi </strong>运行bash脚本，该角色是我在前面的配置脚本中指定的角色。</p>

<p>【T2 <img src="../Images/77d4428335ca34bc810cb72866703815.png" class="img-fluid center" alt="Script step" data-original-src="https://i.octopus.com/blog/2021-01/tentacle-on-arm/script-step.png"/></p>

<p>针对一个角色运行，意味着您可能有许多具有相同角色的目标，执行将针对每个目标运行。添加一个调度触发器，您就有了一个真正的DevOps流程。</p>

<p>这是一个简单的例子，这也可能是一个在Raspberry Pi上更新PiHole ( <code>pi-hole -up</code>)或清理Docker图像(<code>docker images prune --force</code>)的操作手册，或者是一个将最新版本的内部Python应用程序部署到远程物联网监控设备的部署项目。</p>

<h2 id="conclusion">结论</h2>

<p>使用ARM硬件的原因有很多，从成本节约到性能或远程物联网设备。能够通过触手将它们连接到Octopus实例允许您向它们部署应用程序更新，或者使用我们的<a href="https://octopus.com/docs/runbooks"> Runbooks </a>功能来集中管理操作系统和应用程序。轮询触手的额外好处是避免复杂的防火墙配置，并在公共互联网上暴露SSH端口。</p>

                    
                    
</body>
</html>