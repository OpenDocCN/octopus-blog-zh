<html>
<head>
<title>Octopus 3.0: Migrator RFC - Octopus Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Octopus 3.0:迁移器RFC - Octopus部署</h1>
<blockquote>原文：<a href="https://octopus.com/blog/octopus-3.0-migrator-rfc#2015-09-25">https://octopus.com/blog/octopus-3.0-migrator-rfc#2015-09-25</a></blockquote>
                        <p>章鱼2.6使用RavenDB，而<a href="https://octopusdeploy.com/blog/3.0-switching-to-sql">章鱼3.0使用SQL Server </a>。当然，这意味着我们需要某种方法来帮助您将数据从2.6迁移到3.0。既然我们在数据迁移上投入了如此多的精力，我们不妨让它成为一个特色:它也将成为一个<strong>通用章鱼3.0出口者和入口者</strong>。</p>

<p>迁移工具将支持以下四种情况:</p>

<ul>
<li>将数据从2.6版导入3.0版服务器</li>
<li>从3.0服务器导出数据，并将其导入回3.0服务器</li>
<li>将3.0服务器中的数据拆分为两个或更多</li>
<li>将多个3.0服务器中的数据合并为一个</li>
</ul>

<p>我们将导入和导出的数据限于“配置”风格的数据(例如，项目、环境、机器、部署过程、变量集、团队、NuGet提要等等)。我们不打算支持导出历史数据(即发布、部署和审核事件)，但我们最终会从2.6备份中导入历史数据。</p>

<h2>出口</h2>

<p><img src="../Images/2fca81aecdaaf2e2dc702e08fe6075f5.png" alt="Exporter UI in Octopus 3.0" data-original-src="https://i.octopus.com/blog/migrated/2015-05-21_10_29_49-Untitled_-_Notepad_dkb5ym.png"/></p>

<p>exporter工具将数据导出为目录中的JSON文件。</p>

<p><img src="../Images/68426e4ef5c188bd58974c4bd7a6b5b8.png" alt="Exported directory" data-original-src="https://i.octopus.com/blog/migrated/2015-05-21_10_38_52-Exported_-_C__GitHub_OctopusDeploy_source_Octopus.IntegrationTests_bin_Exported_uvq97y.png"/></p>

<p>你能用这个出口做什么？</p>

<ul>
<li><strong>提交到Git库</strong> <br/>我们尽可能地让JSON变得友好和可预测，这样如果您提交多个导出，唯一会出现的差异是已经做出的实际更改，比较这些更改将是显而易见的。</li>
<li><strong>将其转移到新的Octopus服务器</strong> <br/>您可以删除不想导入的文件(例如，如果您正在转移一个项目，只删除除该项目的文件之外的所有文件)，然后使用导入器将其导入。</li>
</ul>

<p>虽然JSON文件包含ID，但是在导入时，我们实际上使用名称来确定某些内容是否已经存在。这意味着您可以从多个Octopus服务器导出，将它们组合在一起，然后导入到单个Octopus服务器。</p>

<p>如果您使用敏感变量，这些变量将使用密码在JSON中加密(注意，敏感变量通常存储在使用您的主密钥加密的SQL中；导出器将解密它们，然后用这个新密码加密它们)。假设您在两次导出之间使用相同的密码，您将获得相同的输出，因此它们不会在您的diff工具中显示为已更改。</p>

<h2>进口</h2>

<p><img src="../Images/0c53598c1f0353918ad61935a42f7dcf.png" alt="Importer in Octopus 3.0" data-original-src="https://i.octopus.com/blog/migrated/2015-05-21_10_29_29-Untitled_-_Notepad_hhwyw4.png"/></p>

<p>导入工具可以获取导出的目录和用于导出它的密码，或者Octopus 2.6备份文件(<code>.octobak</code>)和Octopus主密钥。然后它将导入数据。</p>

<p>您将有机会先预览这些更改，并且您可以告诉该工具:</p>

<ul>
<li>如果目标中已经存在文档，则覆盖它们(例如，如果已经存在同名项目，则覆盖它)</li>
<li>如果目标中已经存在文档，则跳过这些文档(例如，如果已经存在同名项目，则不执行任何操作)</li>
</ul>

<p>导入器将所有数据更改包装在一个SQL事务中；如果在导入过程中发现任何问题，事务将被回滚，不会导入任何内容。</p>

<h2>历史重要吗？</h2>

<p>正如我提到的，我们目前在即将到来的3.0公开测试版中遗漏的一个特性是导出和导入部署历史(甚至从2.6开始)——也就是说，发布、部署、任务、工件和审计事件将不会被导出或导入。这些要复杂得多，所以我们计划按原样发布这个工具，以后再添加历史。</p>

<p>我们肯定会在3.0发布之前扩展导入器，从2.6备份中导入历史。我们不确定的是，在3.0中导入和导出历史是否重要——我们发现绝大多数人只关心项目配置数据，而不关心历史。我们希望听到一些3.0历史导入可能有用的场景。</p>

<p>PS:喜欢新的管理工具外观吗？</p>

                    
                    
</body>
</html>