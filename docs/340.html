<html>
<head>
<title>Introducing Buildkite integration - Octopus Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>介绍Buildkite集成- Octopus Deploy</h1>
<blockquote>原文：<a href="https://octopus.com/blog/introducing-buildkite-integration#2022-08-31">https://octopus.com/blog/introducing-buildkite-integration#2022-08-31</a></blockquote>
                        <p>章鱼部署现在与<a href="https://buildkite.com/" rel="nofollow"> Buildkite </a>整合。我们新的Buildkite插件将允许您的构建代理创建和部署版本，推送构建信息，并作为管道的一部分运行runbooks。</p>

<p>这篇文章向您展示了如何使用Buildkite插件来执行各种操作，Octopus Deploy是Buildkite中管道的一部分。</p>

<h2 id="what-is-buildkite">什么是Buildkite？</h2>

<p>Buildkite是一个在基础设施上运行持续集成(CI)管道的平台。这使得它快速、安全且可扩展。</p>

<p>构建是通过代理进行的。这些是小型的、可靠的、跨平台的构建运行程序，通过YAML定义的工作流来控制。</p>

<p>代理也可以通过插件进行扩展。这些为工作流提供了额外的功能。它们执行Docker容器中的步骤，从凭证存储中读取值，并向构建添加测试摘要注释。</p>

<h2 id="buildkite-integration-with-octopus-deploy">与Octopus Deploy集成Buildkite</h2>

<p>以下插件支持Buildkite与Octopus Deploy的集成:</p>



<p>这些插件要求在Buildkite代理上安装<a href="https://octopus.com/downloads/octopuscli"> Octopus CLI </a>。</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-02/introducing-buildkite-integration/buildkite-agent-runs.png" class="zoom" data-title=""><img src="../Images/bd6e7f1ce920ef609e33690f40af64a5.png" class="img-fluid center" alt="Buildkite Agent Runs" data-original-src="https://i.octopus.com/blog/2022-02/introducing-buildkite-integration/buildkite-agent-runs.png"/>T2】</a></p>

<h2 id="creating-a-release">创建版本</h2>

<p>在Octopus Deploy中，一个发布是您的部署过程和相关资产(包、脚本、变量)的快照，因为它们在您的发布创建时就存在。该发行版有一个版本号，您可以根据需要多次部署该发行版，即使自该发行版创建以来部分部署过程已经更改(这些更改将包含在未来的发行版中，但不包含在当前版本中)。</p>

<p>当您部署该版本时，您正在执行带有所有相关细节的部署过程，因为它们在创建该版本时就存在了。</p>

<p>通过Buildkite在Octopus Deploy中创建一个发布会将<a href="https://github.com/OctopusDeploy/create-release-buildkite-plugin" rel="nofollow">create-release-build kite-plugin</a>合并到您的管道中:</p>

<pre><code class="language-yaml">steps:
  - label: Create a release in Octopus Deploy 🐙
  - plugins: 
    - OctopusDeploy/create-release#v0.0.1:
        api_key: "${MY_OCTOPUS_API_KEY}"
        project: "HelloWorld"
        server: "${MY_OCTOPUS_SERVER}"
</code></pre>

<p>我们强烈建议您将环境变量用于敏感值，如API键或服务器地址。</p>


<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-02/introducing-buildkite-integration/buildkite-agent-runs-output.png" class="zoom" data-title=""><img src="../Images/97152dbc0435170f2b9db1c630d0e985.png" class="img-fluid center" alt="Buildkite Agent Runs Output" data-original-src="https://i.octopus.com/blog/2022-02/introducing-buildkite-integration/buildkite-agent-runs-output.png"/></a>T2】</p>

<h2 id="pushing-build-information">推送构建信息</h2>

<p>当部署一个版本时，了解哪个构建产生了工件，它包含什么提交，以及它与哪个工作项相关联是很有用的。构建信息特性允许你从构建服务器上传信息到Octopus Deploy，手动或者通过插件。</p>

<p>构建信息与包相关联，包括:</p>

<ul>
<li>构建URL:指向生成包的构建的链接</li>
<li>提交:与构建相关的源提交的详细信息</li>
<li>问题:从提交消息中解析的问题引用</li>
</ul>

<p>从Buildkite推送构建信息到Octopus Deploy可以通过<a href="https://github.com/OctopusDeploy/push-build-information-buildkite-plugin" rel="nofollow">push-build-information-build kite-plugin</a>完成:</p>

<pre><code class="language-yaml">steps:
  - label: Push build info to Octopus Deploy 🐙
    plugins: 
      - OctopusDeploy/push-build-information#v0.0.1:
          api_key: "${MY_OCTOPUS_API_KEY}"
          packages: "HelloWorld"
          package_version: "1.0.0"
          server: "${MY_OCTOPUS_SERVER}"
</code></pre>

<h2 id="running-a-runbook">运行操作手册</h2>

<p>Runbooks可自动执行日常维护和紧急操作任务，例如基础设施供应、数据库管理以及网站故障转移和恢复。runbook包括运行基础设施的所有必要权限，因此团队中的任何人都可以执行run book，并且因为它们是在Octopus中管理的，所以有完整的审计跟踪。Runbooks可以使用提示变量，因此需要人工交互。</p>

<p>可以使用<a href="https://github.com/OctopusDeploy/run-runbook-buildkite-plugin" rel="nofollow">run-runbook-Buildkite-plugin</a>通过build kite在Octopus Deploy中运行run book:</p>

<pre><code class="language-yaml">steps:
  - label: Run runbook in Octopus Deploy 🐙
    plugins: 
      - OctopusDeploy/run-runbook#v0.0.1:
          api_key: "${MY_OCTOPUS_API_KEY}"
          environments: "Test"
          project: "Hello World"
          runbook: "Greeting"
          server: "${MY_OCTOPUS_SERVER}"
</code></pre>

<h2 id="conclusion">结论</h2>

<p>通过我们新的Buildkite插件提供的集成代表了我们最初的设计和发布。我们计划构建额外的插件，并通过Bash脚本提供集成来消除对Octopus CLI的依赖。</p>

<p>如果您是现有的Octopus Deploy客户，请查看作为构建管道一部分的<a href="https://buildkite.com/" rel="nofollow"> Buildkite </a>。如果你是一个现有的Buildkite客户，请查看<a href="https://octopus.com/start"> Octopus Deploy </a>了解部署情况。如果您还没有尝试过这两种产品，请将它们都视为您CI/CD渠道的一部分。</p>

<p>愉快的部署！</p>

                    
                    
</body>
</html>