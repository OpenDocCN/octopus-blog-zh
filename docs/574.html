<html>
<head>
<title>How to use PowerShell script modules... on Linux - Octopus Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何使用PowerShell脚本模块...在Linux上——Octopus部署</h1>
<blockquote>原文：<a href="https://octopus.com/blog/posh-modules-linux#2022-08-08">https://octopus.com/blog/posh-modules-linux#2022-08-08</a></blockquote>
                        <p><a href="#" data-featherlight="https://i.octopus.com/blog/2018-03/blogimage-powershell-linux.png" class="zoom" data-title=""><img src="../Images/be9802861f231287cc19d008c3b98b61.png" class="img-fluid center" alt="Tux the Penguin reading a Powershell book" data-original-src="https://i.octopus.com/blog/2018-03/blogimage-powershell-linux.png"/>T2】</a></p>

<p>Octopus Deploy支持可重用的<a href="https://octopus.com/docs/deployments/custom-scripts/script-modules"> PowerShell脚本模块</a>，这些模块可以包含在所有项目的部署中。当脚本模块包含在项目中时，它将自动可供在Windows上运行的PowerShell脚本使用。您还可以在Linux上运行您喜欢的PowerShell脚本模块，但是它们不会自动提供给Linux脚本上的PowerShell。虽然我们计划在Linux上提供一流的PowerShell支持，但下面是让它们工作的技巧。</p>

<p>在本例中，我们将使用一个名为<code>Say Hello</code>的脚本模块，其内容如下:</p>

<pre><code>function Say-Hello($name)
{
    Write-Output "Hello $name. Welcome to Octopus!"
}
</code></pre>

<p>如需在Octopus中创建脚本模块的帮助，请遵循文档中的<a href="https://octopus.com/docs/deployments/custom-scripts/script-modules">说明。</a></p>

<p>我们将使用一个名为<code>PowerShell modules on Linux</code>的项目，它包含了<code>Say Hello</code>脚本模块。我们的部署流程包括一个从PowerShell调用<code>Say-Hello</code>方法的<code>Run a Script</code>步骤。我们天真的bash脚本应该是这样的:</p>

<pre><code>pwsh -Command "Say-Hello"
</code></pre>

<p>如果我们尝试运行此脚本，我们会遇到一条错误消息，指出脚本模块尚未加载:</p>

<blockquote class="blockquote">
<p>术语“Say-Hello”不被识别为cmdlet、函数、脚本文件或可运行程序的名称。</p>
</blockquote>

<p>脚本模块的内容可用于名为<code>Octopus.Script.Module[Say Hello]</code>的Octopus变量中的步骤。为了在我们的bash脚本中使用脚本模块，我们将检索内容，将它们保存到一个文件中，然后在我们的PowerShell脚本中导入它们。为了简单起见，我们将模块保存到<code>/tmp</code>文件夹中——PowerShell的<code>Import-Module</code>需要一个绝对路径。下面是导入模块后bash脚本的样子:</p>

<pre><code>say_hello_module=$(get_octopusvariable "Octopus.Script.Module[Say Hello]")
echo "$say_hello_module" &gt; /tmp/SayHello.psm1
pwsh -noprofile -Command "&amp;Import-Module /tmp/SayHello.psm1; Say-Hello World"
</code></pre>

<p>当我们运行脚本时，我们的模块被导入，我们看到了预期的输出:</p>

<blockquote class="blockquote">
<p>你好世界。欢迎来到章鱼！</p>
</blockquote>

<p>现在，您可以在Windows和Linux上重用PowerShell脚本模块库。</p>

                    
                    
</body>
</html>