<html>
<head>
<title>New in GitHub Actions for Octopus Deploy - Octopus Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Octopus Deploy的GitHub动作中的新功能- Octopus Deploy</h1>
<blockquote>原文：<a href="https://octopus.com/blog/new-in-github-actions#2022-09-20">https://octopus.com/blog/new-in-github-actions#2022-09-20</a></blockquote>
                        <p>2021年6月，我们<a href="https://octopus.com/blog/github-actions-for-octopus-deploy">在GitHub Marketplace中发布了我们的第一组动作</a>，以将您的GitHub工作流与Octopus Deploy集成。</p>

<p>我们最近改进了这些动作的可用性，并在章鱼部署v2的GitHub动作中增加了一个新动作，作为章鱼2022年第三季度发布的一部分。</p>

<p>我们的更新包括:</p>

<ul>
<li>永远发布标签支持</li>
<li>提高可用性</li>
<li>新的推送构建信息操作</li>
<li>工作摘要</li>
</ul>

<p>在这篇文章中，我将带你了解我们所做的改变，以及你如何从中获得最大收益。</p>

<p>请注意，这篇文章假设你知道用GitHub操作构建工作流的基础知识。要了解更多信息，请访问GitHub文档。</p>


<h2 id="semver-release-tag-support">永远发布标签支持</h2>

<p>为了提高可用性，我们现在在所有的GitHub动作中支持release标签的语义版本化。有了这一改变，您现在可以比以前更容易地在工作流程中引用发行标签:</p>

<pre><code class="language-yaml">uses: OctopusDeploy/create-release-action@v2.0.0 # major.minor.patch
uses: OctopusDeploy/create-release-action@v2.0   # major.minor
uses: OctopusDeploy/create-release-action@v2     # major
</code></pre>

<p>我们对操作所做的任何更改都会自动更新我们的发布标签。这些更改将被合并到您的工作流中，具体取决于它们的引用方式。</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-09/new-in-github-actions/semver-release-tag-support.png" class="zoom" data-title=""><img src="../Images/e4700492b35d660c0cfaa8ab431502a4.png" class="img-fluid center" alt="Screenshot of SemVer Release Tag Support" data-original-src="https://i.octopus.com/blog/2022-09/new-in-github-actions/semver-release-tag-support.png"/>T2】</a></p>

<p>例如，引用仅指定了主要版本的操作意味着您的工作流将自动选取次要版本和修补程序更新附带的更改。</p>

<pre><code class="language-yaml">#use v2 of push-package-action which includes all updates to minor and patch versions
uses: OctopusDeploy/push-package-action@v2

#use v2.1 of push-package-action which includes all updates to patch versions
uses: OctopusDeploy/push-package-action@v2.1

#use v2.1.3 of push-package-action (pinned version; no updates)
uses: OctopusDeploy/push-package-action@v2.1.3
</code></pre>

<p>我们建议您只固定到主版本(v2 ),这样您就可以在错误和安全修复可用时自动受益。</p>

<h2 id="improved-usability">提高可用性</h2>

<p>在查看了数百个公共存储库之后，我们发现我们提供的参数中只有不到一半在工作流中使用。这些参数中有许多是为了支持Octopus CLI而提供的，但是它们并没有在GitHub工作流上下文中使用。因此，我们删除了这些参数以提高可用性。</p>

<p>我们现在还支持对上下文值使用环境变量。我们继续鼓励使用<a href="https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions#using-secrets" rel="nofollow">机密来保护敏感值</a>。</p>

<pre><code class="language-yaml">-name: Create a release in Octopus Deploy 🐙
  uses: OctopusDeploy/create-release-action@v2
  env:
    OCTOPUS_API_KEY: ${{ secrets.API_KEY  }}
    OCTOPUS_HOST: ${{ secrets.SERVER }}
    OCTOPUS_SPACE: 'Spaces-1'
  with:
    project: 'MyProject'
</code></pre>

<p>我们GitHub动作的所有READMEs都已经更新到<a href="https://github.com/OctopusDeploy/create-release-action/blob/main/migration-guide.md" rel="nofollow">记录这些变化</a>以及我们支持的<a href="https://github.com/OctopusDeploy/create-release-action#%EF%B8%8F-environment-variables" rel="nofollow">环境变量</a>。</p>

<h2 id="push-build-information-action">推送构建信息操作</h2>

<p>构建信息是Octopus Deploy一个重要特性，它驱动了许多部署后功能。在针对Octopus Deploy v2的GitHub Actions中，我们添加了对通过新动作发送构建信息的支持，<a href="https://github.com/OctopusDeploy/push-build-information-action" rel="nofollow">推送-构建-信息-动作</a>。</p>

<p>这个GitHub动作允许您向Octopus提供详细的提交、构建和发布跟踪信息，这些信息可以作为发行说明出现。您可以使用此功能与每个生产部署的利益相关者共享发行说明，并在尝试隔离特定版本中引入的bug时，跟踪从部署到构建和提交的链接。</p>

<pre><code class="language-yaml">env:
  OCTOPUS_API_KEY: ${{ secrets.OCTOPUS_API_KEY }} # API key used with Octopus Deploy
  OCTOPUS_HOST: ${{ secrets.OCTOPUS_HOST }}       # address of Octopus Deploy
  OCTOPUS_SPACE: '[space-name-or-space-id]'
steps:
  -uses: actions/checkout@v2
  -name: Push build information to Octopus Deploy 🐙
    uses: OctopusDeploy/push-build-information-action@v1
    with:
      packages: '[package-id]'
      version: '[version-of-packages]'
</code></pre>

<p>仔细观察上面的YAML，可以发现它对Octopus CLI没有依赖性。那是因为这个动作第一次使用了我们的<a href="https://github.com/OctopusDeploy/api-client.ts" rel="nofollow"> TypeScript API客户端库</a>。</p>

<h2 id="job-summaries">工作摘要</h2>

<p><a href="https://github.blog/2022-05-09-supercharging-github-actions-with-job-summaries/" rel="nofollow"> GitHub在2022年5月宣布了GitHub行动的工作总结</a>，我们想要支持它。以前，动作输出仅限于日志和注释，很难对大量信息进行聚合和分组。</p>

<p>使用Octopus Deploy v2的GitHub Actions，您可以看到由<a href="https://github.com/OctopusDeploy/create-release-action" rel="nofollow">创建-发布-操作</a>和<a href="https://github.com/OctopusDeploy/push-package-action" rel="nofollow">推送-打包-操作</a>生成的作业摘要，这样更容易理解:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-09/new-in-github-actions/job-summary-create-release.png" class="zoom" data-title=""><img src="../Images/b7e7adadf925e50b83e92b3441793da2.png" class="img-fluid center" alt="Screenshot of job summary for create release action" data-original-src="https://i.octopus.com/blog/2022-09/new-in-github-actions/job-summary-create-release.png"/>T2】</a></p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-09/new-in-github-actions/job-summary-run-action.png" class="zoom" data-title=""><img src="../Images/44c97d7ce96ddbc4ff4409a589639dba.png" class="img-fluid center" alt="Screenshot of job summary for push package action" data-original-src="https://i.octopus.com/blog/2022-09/new-in-github-actions/job-summary-run-action.png"/>T2】</a></p>

<h2 id="conclusion">结论</h2>

<p>用于Octopus Deploy v2的GitHub Actions现已推出。更新包括SemVer发布标签支持、改进的可用性、新的推送构建信息步骤和对作业摘要的支持。</p>

<p>我们希望你喜欢我们为Octopus Deploy v2在GitHub Actions中所做的更改。</p>

<p>愉快的部署！</p>

                    
                    
</body>
</html>