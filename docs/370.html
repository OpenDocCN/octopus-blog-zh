<html>
<head>
<title>How to install Jenkins on Windows and Linux - Octopus Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在Windows和Linux上安装Jenkins-Octopus Deploy</h1>
<blockquote>原文：<a href="https://octopus.com/blog/jenkins-install-guide-windows-linux#2022-05-19">https://octopus.com/blog/jenkins-install-guide-windows-linux#2022-05-19</a></blockquote>
                        <p>传统的Jenkins安装方法是使用在<a href="https://www.jenkins.io/download/" rel="nofollow"> Jenkins网站</a>上提供的安装程序，或者通过您本地操作系统的软件包管理器。安装过程通常很简单，但是需要注意一些技巧。</p>

<p>在这篇文章中，我们将介绍Jenkins在Windows和Linux上的安装，以及如何定制安装。</p>

<h2 id="choosing-between-jenkins-lts-and-weekly-releases">詹金斯LTS和每周发行之间的选择</h2>

<p>Jenkins提供了两种发布渠道:</p>

<ul>
<li>长期支持(LTS)</li>
<li>每周发布</li>
</ul>

<p>LTS版本往往更加稳定和可预测，每个次要版本中的功能更少，但包括任何重要的错误和安全修复。</p>

<p>每周发布的版本包含了所有最新的特性，但是在社区中用于查找bug的“烘烤时间”更少。</p>

<p>如果你喜欢稳定性，并且不需要所有的最新功能，那么就选择LTS版本。如果你想尽快获得最新的特性，并且不介意偶尔的小故障，那就选择每周发布。</p>

<h2 id="how-to-install-jenkins-on-windows">如何在Windows上安装Jenkins</h2>

<p>Jenkins提供了MSI下载，允许它通过传统的Windows向导式安装过程作为Windows服务安装。但是在开始安装之前，您必须满足一些先决条件。</p>

<h3 id="installing-openjdk">正在安装OpenJDK</h3>

<p>Jenkins需要Java来运行，OpenJDK项目提供了一个免费的开源发行版，您可以使用它来运行Jenkins。</p>

<p>有许多OpenJDK发行版可供选择，包括:</p>



<p>我通常使用Azul Zulu发行版，但任何发行版都可以。</p>

<p>从您选择的OpenJDK发行版下载并安装JDK 11，并记下它的安装目录，因为在Jenkins安装期间您将需要该路径。</p>

<h3 id="adding-a-jenkins-windows-service-account">添加Jenkins Windows服务帐户</h3>

<p>Jenkins作为Windows服务运行，并且需要一个Windows帐户来运行该服务。安装程序提供了使用现有的<a href="https://docs.microsoft.com/en-us/windows/win32/services/localservice-account" rel="nofollow"> LocalService </a>帐户的选项，但是指出不推荐使用该选项。建议的解决方案是创建一个专门用于运行Jenkins的新帐户。</p>

<p>要从命令行执行此任务，您必须首先安装<a href="http://get-carbon.org/" rel="nofollow"> Carbon PowerShell模块</a>。Carbon为管理Windows提供了许多有用的CMDLets，您将使用其中的一个来授予新的Jenkins用户作为服务登录的权限。</p>

<p>运行以下PowerShell命令从PowerShell Gallery安装Carbon:</p>

<pre><code class="language-powershell">Install-Module -Name 'Carbon' -AllowClobber
</code></pre>

<p>默认情况下，PowerShell会阻止您从外部来源运行代码。若要删除此警告，请运行以下命令:</p>

<pre><code class="language-powershell">Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
</code></pre>

<p>然后你进口碳:</p>

<pre><code class="language-powershell">Import-Module 'Carbon'
</code></pre>

<p>下一步是创建一个名为<code>jenkins</code>的用户来运行Jenkins Windows服务:</p>

<pre><code class="language-powershell">net user jenkins Password01! /ADD
</code></pre>

<p>最后，您必须授予<code>jenkins</code>用户作为服务登录的权限:</p>

<pre><code class="language-powershell">Grant-CPrivilege -Identity "jenkins" -Privilege SeServiceLogonRight
</code></pre>

<h3 id="installing-jenkins">安装Jenkins</h3>

<p>从<a href="https://www.jenkins.io/download/" rel="nofollow"> Jenkins下载页面</a>下载MSI，双击MSI文件开始安装Jenkins，点击<strong>下一步</strong>按钮:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-1.png" class="zoom" data-title=""><img src="../Images/a1a5db493d48ba0a2eb7a6390ac73547.png" class="img-fluid center" alt="Jenkins Windows Installer welcome screen" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-1.png"/>T2】</a></p>

<p>默认安装目录就可以了，所以点击<strong>下一个</strong>按钮:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-2.png" class="zoom" data-title=""><img src="../Images/39e9b0ade3a3cf2deee1c1e02d38bc93.png" class="img-fluid center" alt="Jenkins Windows Installer showing Destination Folder screen" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-2.png"/>T2】</a></p>

<p>现在会提示您提供运行Windows服务的用户的详细信息。输入您之前创建的用户的凭证，并点击<strong>测试凭证</strong>按钮。测试通过后，点击<strong>下一个</strong>按钮:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-3.png" class="zoom" data-title=""><img src="../Images/956d1a9337193f2e6721365ea90476d4.png" class="img-fluid center" alt="Jenkins Windows Installer showing Service Logon Credentials screen with Run service as local or domain user selected" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-3.png"/>T2】</a></p>

<p><strong> 8080 </strong>默认端口没问题。点击<strong>测试端口</strong>按钮，确保端口可用，然后点击<strong>下一个</strong>按钮:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-4.png" class="zoom" data-title=""><img src="../Images/c6f06656c5da7a4516de469b7ea76e6d.png" class="img-fluid center" alt="Jenkins Windows Installer showing Port Selection screen with Port Number 8080 entered in the Port Number field" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-4.png"/>T2】</a></p>

<p>现在提示您输入先前安装的Java发行版的路径。祖鲁11发行版的默认路径是<code>C:\Program Files\Zulu\zulu-11</code>。为您选择的发行版输入适当的路径，然后单击下一个<strong>按钮</strong>:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-6.png" class="zoom" data-title=""><img src="../Images/f3a129413b210d552f7bdbda9e2beb0d.png" class="img-fluid center" alt="Jenkins Windows Installer open on Select Java home directory screen" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-6.png"/></a>T2】</p>

<p>您可能希望通过Windows防火墙暴露Jenkins，以允许外部客户端访问它。更改要安装的<strong>防火墙例外</strong>特性，点击<strong>下一步</strong>按钮:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-7.png" class="zoom" data-title=""><img src="../Images/450c697e34c1c5077aa31ed508fb0249.png" class="img-fluid center" alt="Jenkins Windows Installer open on Custom Setup screen with Firewall Exception selected" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-7.png"/>T2】</a></p>

<p>现在所有的安装值都已配置好，所以点击<strong>安装</strong>按钮:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-8.png" class="zoom" data-title=""><img src="../Images/f5b733168f9a42c1348f90e79371f71f.png" class="img-fluid center" alt="Jenkins Windows Installer open on Ready To Install Jenkins screen with the Install button highlighted" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-8.png"/>T2】</a></p>

<p>安装完成后，点击<strong>完成</strong>按钮:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-9.png" class="zoom" data-title=""><img src="../Images/df2f93e4913b0b2495a1423c5467f768.png" class="img-fluid center" alt="Jenkins Windows Installer" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/win-install-9.png"/>T2】</a></p>

<h2 id="a-note-on-chocolatey">关于巧克力的一个注记</h2>

<p>Chocolatey是一个Windows包管理器，它<a href="https://community.chocolatey.org/packages/jenkins" rel="nofollow">提供了一个安装詹金斯</a>的选项。然而，在撰写本文时，Chocolatey上可用的Jenkins的最新版本是2.222.4，这已经是一年前的事了。事实上，该版本太旧了，以至于在最初的Jenkins配置中出现的大多数推荐插件都无法安装！</p>

<p>当你读到这篇文章的时候，Jenkins可能已经更新了Chocolatey，但是我警告不要使用Chocolatey来安装Jenkins，因为它确实有过不被维护的历史。</p>

<h2 id="windows-service-configuration">Windows服务配置</h2>

<p>Windows服务有一个<a href="https://docs.microsoft.com/en-au/windows/win32/api/winsvc/nc-winsvc-lpservice_main_functiona?redirectedfrom=MSDN" rel="nofollow">唯一入口点</a>来响应服务控制管理器(SCM)命令。像Jenkins这样的Java应用程序不公开这个接口。这意味着Java应用程序必须在包装器中运行，才能作为Windows服务进行管理。</p>

<p>默认情况下，该包装器位于<code>C:\Program Files\Jenkins\jenkins.exe</code>位置，由<code>C:\Program Files\Jenkins\jenkins.xml</code>文件配置:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-wrapper.png" class="zoom" data-title=""><img src="../Images/89aaa6e7de2a1ccffc9cb58d3c270972.png" class="img-fluid center" alt="Jenkins Wrapper Configuration" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-wrapper.png"/>T2】</a></p>

<p>这个XML文件包含<code>service/arguments</code>元素，它定义了执行时传递给Jenkins的命令行参数。它还包括<code>service/env</code>元素来定义Jenkins可用的环境变量。</p>

<p>高级Jenkins配置选项通常需要传递参数或定义环境变量。例如，<a href="https://www.jenkins.io/doc/book/security/csrf-protection/" rel="nofollow">在Jenkins中禁用跨站点请求伪造(CSRF)保护</a>需要传递<code>-Dhudson.security.csrf.GlobalCrumbIssuerConfiguration.DISABLE_CSRF_PROTECTION=true</code>参数，该参数在<code>service/arguments</code>元素中配置:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-wrapper-2.png" class="zoom" data-title=""><img src="../Images/cf0715573aae8e1556a453fb8900bbf3.png" class="img-fluid center" alt="Jenkins Wrapper Configuration" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-wrapper-2.png"/>T2】</a></p>

<p>詹金斯系统属性列表可以在<a href="https://www.jenkins.io/doc/book/managing/system-properties/" rel="nofollow">詹金斯文档</a>中找到。</p>

<h2 id="jenkins_home-directory-on-windows">Windows上的JENKINS_HOME目录</h2>

<p><code>JENKINS_HOME</code>目录包括所有的配置、插件和在Jenkins服务器上执行的任何构建的工作目录。在Windows上，该目录默认位于<code>%LocalAppData%\Jenkins\.jenkins</code>，当使用上面创建的<code>jenkins</code>用户运行Jenkins服务时，该目录将解析为<code>C:\Users\jenkins\AppData\Local\Jenkins\.jenkins</code>。</p>

<h2 id="how-to-install-jenkins-on-ubuntu-and-debian">如何在Ubuntu和Debian上安装Jenkins</h2>

<p>Jenkins提供了一个<a href="https://pkg.jenkins.io/debian-stable/" rel="nofollow">包存储库，用于在Debian和Ubuntu </a>上安装软件。</p>

<p>首先，安装存储库密钥:</p>

<pre><code class="language-bash">wget -q -O - https://pkg.jenkins.io/debian-stable/jenkins.io.key | sudo apt-key add -
</code></pre>

<p>然后添加一个Jenkins apt存储库条目:</p>

<pre><code class="language-bash">sudo sh -c 'echo deb https://pkg.jenkins.io/debian-stable binary/ &gt; /etc/apt/sources.list.d/jenkins.list'
</code></pre>

<p>更新您的本地包索引，然后最后安装Jenkins:</p>

<pre><code class="language-bash">sudo apt-get update
sudo apt-get install openjdk-11-jdk
sudo apt-get install jenkins
</code></pre>

<h2 id="how-to-install-jenkins-on-rhel-and-fedora">如何在RHEL和Fedora上安装Jenkins</h2>

<p>Jenkins提供了一个<a href="https://pkg.jenkins.io/redhat-stable/" rel="nofollow">包存储库，用于在Red Hat Enterprise Linux (RHEL)和Fedora </a>上安装软件。</p>

<p>首先，安装存储库密钥:</p>

<pre><code class="language-bash">sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo
sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key
</code></pre>

<p>然后安装OpenJDK和Jenkins:</p>

<pre><code class="language-bash">sudo yum install epel-release
sudo yum install java-11-openjdk-devel
sudo yum install jenkins
</code></pre>

<h2 id="linux-service-configuration">Linux服务配置</h2>

<p>虽然Ubuntu、Debian、RHEL和Fedora的所有现代版本都使用<a href="https://systemd.io/" rel="nofollow"> systemd </a>，但Jenkins服务仍然作为旧的init脚本在<code>/etc/init.d/jenkins</code>下提供。</p>

<p>为了启动服务，我们运行<code>service</code>命令:</p>

<pre><code class="language-bash">sudo service jenkins start
</code></pre>

<p>init脚本<code>/etc/init.d/jenkins</code>包含了相当多的Bash脚本，但是从管理员的角度来看，这是最有趣的一行:</p>

<pre><code class="language-bash">eval "daemonize -u \"$JENKINS_USER\" -p \"$JENKINS_PID_FILE\" \"$JENKINS_JAVA_CMD\" $JENKINS_JAVA_OPTIONS \"-DJENKINS_HOME=$JENKINS_HOME\" -jar \"$JENKINS_WAR\" $PARAMS"
</code></pre>

<p>您可以从上面的代码中确定要传递给Jenkins的Java选项包含在<code>JENKINS_JAVA_OPTIONS</code>变量中。要填充这个变量，在<code>### END INIT INFO</code>后添加一行如下所示的代码。本例<a href="https://www.jenkins.io/doc/book/security/csrf-protection/" rel="nofollow">禁用CSRF保护</a>:</p>

<pre><code class="language-bash">###############################################################################
#
# chkconfig: 35 99 01
# description: Jenkins Automation Server
#
###############################################################################
### BEGIN INIT INFO
# Provides:          jenkins
# Required-Start:    $local_fs $remote_fs $network $time $named
# Should-Start: $time sendmail
# Required-Stop:     $local_fs $remote_fs $network $time $named
# Should-Stop: $time sendmail
# Default-Start:     3 5
# Default-Stop:      0 1 2 6
# Short-Description: Jenkins Automation Server
# Description:       Jenkins Automation Server
### END INIT INFO

[ -n "$JENKINS_JAVA_OPTIONS" ] &amp;&amp; JENKINS_JAVA_OPTIONS="-Dhudson.security.csrf.GlobalCrumbIssuerConfiguration.DISABLE_CSRF_PROTECTION=true"

# Rest of the init script
</code></pre>

<p>Jenkins系统属性列表可在<a href="https://www.jenkins.io/doc/book/managing/system-properties/" rel="nofollow"> Jenkins文档</a>中找到。</p>

<h2 id="how-to-install-jenkins-on-other-linux-distributions-and-macos">如何在其他Linux发行版和macOS上安装Jenkins</h2>

<p>Jenkins网站<a href="https://www.jenkins.io/download/" rel="nofollow">包括其他Linux发行版和macOS的说明。</a></p>

<h2 id="completing-the-jenkins-installation">完成Jenkins安装</h2>

<p>安装完Jenkins后，您需要进行第一次配置。</p>

<p>打开<a href="http://localhost:8080" rel="nofollow"> http://localhost:8080 </a>查看Jenkins web控制台。系统会提示您输入随机生成的密码，该密码保存在本地计算机上的一个文件中。</p>

<p>打开该文件，复制密码，粘贴到<strong>管理员密码</strong>文本框中，点击<strong>继续</strong>按钮:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-config-1.png" class="zoom" data-title=""><img src="../Images/2acdeaf2dd8ee4e6e587a06aba7234f7.png" class="img-fluid center" alt="Jenkins Configuration open on Unlock Jenkins page" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-config-1.png"/>T2】</a></p>

<p>大多数Jenkins功能由<a href="https://plugins.jenkins.io/" rel="nofollow">插件</a>提供。作为初始配置的一部分，系统会提示您选择安装公共插件的精选列表。这些插件通常是有用的，所以点击<strong>安装建议插件</strong>按钮:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-config-2.png" class="zoom" data-title=""><img src="../Images/bd74cfebc5ad2de682af655c4f60bc27.png" class="img-fluid center" alt="Jenkins Configuration showing Customize Jenkins screen with Install suggested plugins selected" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-config-2.png"/></a>T2】</p>

<p>安装插件需要几分钟时间:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-config-3.png" class="zoom" data-title=""><img src="../Images/aab0147d43dfb52111e79f5e5222f075.png" class="img-fluid center" alt="Jenkins Configuration screen showing Getting started progress bar" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-config-3.png"/>T2】</a></p>

<p>系统会提示您提供Jenkins管理员的详细信息。填充字段，并点击<strong>保存并继续</strong>按钮:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-config-4.png" class="zoom" data-title=""><img src="../Images/1d026a38484387de354a24a0ee157091.png" class="img-fluid center" alt="Jenkins Configuration screen showing Create First Admin User with Save and Continue button highlighted" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-config-4.png"/>T2】</a></p>

<p>默认网址是好的，所以点击<strong>保存并完成</strong>按钮:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-config-5.png" class="zoom" data-title=""><img src="../Images/5af874b86863bdf2400961ec482647a3.png" class="img-fluid center" alt="Jenkins Configuration showing Instance Configuration screen" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-config-5.png"/>T2】</a></p>

<p>Jenkins现在已经配置好，可以使用了。点击<strong>开始使用詹金斯</strong>按钮:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-config-6.png" class="zoom" data-title=""><img src="../Images/5e001c5e6aa8ff4e6499a98c7c332147.png" class="img-fluid center" alt="Jenkins Configuration screen showing Jenkins is ready message" data-original-src="https://i.octopus.com/blog/2022-01/jenkins-install-guide-windows-linux/jenkins-config-6.png"/>T2】</a></p>

<h2 id="conclusion">结论</h2>

<p>这篇文章分析了Jenkins在Windows和主要Linux发行版中的安装过程，并提供了管理Jenkins服务的技巧。</p>

<p>传统安装只是让Jenkins服务器启动并运行的一种方法。在下一篇文章中，你将学习<a href="https://octopus.com/blog/jenkins-docker-install-guide">如何用Docker </a>安装Jenkins。</p>

<p>试试我们免费的Jenkins管道生成器工具用Groovy语法创建一个管道文件。这是您启动管道项目所需的一切。</p>

<h2 id="watch-our-jenkins-pipeline-webinar">观看我们的詹金斯管道网络研讨会</h2>

<iframe src="https://www.youtube.com/embed/D_7AHTML_xw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">VIDEO</iframe>

<p>我们定期举办网络研讨会。请参见<a href="https://octopus.com/events">网络研讨会第</a>页，了解关于即将举办的活动和实时流媒体录制的详细信息。</p>

<p>阅读我们的<a href="https://octopus.com/blog/tag/CI%20Series">持续集成系列</a>的其余部分。</p>

<p>愉快的部署！</p>

                    
                    
</body>
</html>