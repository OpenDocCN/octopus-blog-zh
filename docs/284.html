<html>
<head>
<title>Announcing GitHub Actions for Octopus Deploy - Octopus Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>å®£å¸ƒGitHubå¯¹Octopus Deployçš„æ“ä½œ- Octopus Deploy</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://octopus.com/blog/github-actions-for-octopus-deploy#2022-08-10">https://octopus.com/blog/github-actions-for-octopus-deploy#2022-08-10</a></blockquote>
                        <p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-06/github-actions-for-octopus-deploy/github-actions-integration.png" class="zoom" data-title=""><img src="../Images/8749de1bf5c55a0705619744eeeb35c2.png" class="img-fluid center" alt="GitHub actions integrating with Octopus Deploy build" data-original-src="https://i.octopus.com/blog/2021-06/github-actions-for-octopus-deploy/github-actions-integration.png"/>T2ã€‘</a></p>

<p>æˆ‘ä»¬å·²ç»ä¸ºOctopus Deployå‘å¸ƒäº†æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå®˜æ–¹GitHubåŠ¨ä½œã€‚è¿™äº›åˆå§‹æ“ä½œæ¶µç›–äº†å°†GitHubæ„å»ºä¸Octopusä¸­çš„éƒ¨ç½²å’Œrunbookè¿è¡Œç›¸è¿æ¥çš„æ ¸å¿ƒé›†æˆåœºæ™¯:</p>



<p>æˆ‘ä»¬è®¡åˆ’åœ¨ä»Šå¹´æ™šäº›æ—¶å€™æ·»åŠ æ›´å¤šçš„GitHubåŠ¨ä½œã€‚</p>

<p>åœ¨è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘æ¼”ç¤ºäº†å¦‚ä½•å¼€å§‹ä½¿ç”¨GitHub Actionså°†æ„å»ºå·¥ä»¶æ¨é€åˆ°Octopusï¼Œåˆ›å»ºä¸€ä¸ªç‰ˆæœ¬ï¼Œå¹¶å°†å…¶éƒ¨ç½²åˆ°å¼€å‘ç¯å¢ƒä¸­ã€‚</p>

<h2 id="what-is-github-actions">ä»€ä¹ˆæ˜¯GitHub Actionsï¼Ÿ</h2>

<p><a href="https://docs.github.com/en/actions" rel="nofollow"> GitHub Actions </a>æ˜¯ä¸€ä¸ªæµè¡Œçš„æ–°å¹³å°ï¼Œç”¨äºè‡ªåŠ¨åŒ–è½¯ä»¶å¼€å‘å·¥ä½œæµï¼Œå¦‚å›´ç»•GitHubç”Ÿæ€ç³»ç»Ÿæ„å»ºçš„CI/CDã€‚</p>

<p>æ‚¨ä½¿ç”¨YAMLé…ç½®æ–‡ä»¶å®šä¹‰æ‚¨çš„å·¥ä½œæµï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨æ‚¨çš„Gitå­˜å‚¨åº“ä¸­ã€‚æ‚¨å¯ä»¥ç”¨ç§°ä¸ºæ“ä½œçš„å¯é‡ç”¨æ„å»ºå—æ¥æ„å»ºè‡ªåŠ¨åŒ–ã€‚å·¥ä½œæµåœ¨å®¹å™¨ä¸­æ‰§è¡Œï¼Œå®ç°å¯é‡å¤ä¸”å¯é çš„æµç¨‹ã€‚</p>

<p>ä¸‹é¢æ˜¯ä¸€ä¸ªGitHub Action jobå·¥ä½œæµçš„ä¾‹å­ã€‚NET webåº”ç”¨ç¨‹åºã€‚GitHubæä¾›äº†å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€å’Œæ¡†æ¶çš„ä¾‹å­ã€‚</p>

<pre><code class="language-yaml">name: Build

on:
  push:
    branches: [ master ]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Setup .NET
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: 5.0.x
    - name: Restore dependencies
      run: dotnet restore
    - name: Build
      run: dotnet publish -o build 
    - name: Test
      run: dotnet test --no-build --verbosity normal
</code></pre>

<p>è¿™ä¸ªå·¥ä½œæµè¢«å‘½åä¸º<strong> build </strong>ï¼Œæ¯å½“å˜æ›´è¢«æ¨é€åˆ°<code>master</code>åˆ†æ”¯ä¸Šçš„çˆ¶Gitä»“åº“æ—¶ï¼Œå®ƒå°±ä¼šè§¦å‘ä¸€ä¸ªå•ä¸€çš„ä½œä¸šã€‚å‡†å¤‡å’Œæ‰§è¡ŒæŒç»­é›†æˆæ„å»ºçš„æ­¥éª¤åŒ…æ‹¬:</p>

<ul>
<li>æ¢å¤ä¾èµ–å…³ç³»</li>
<li>æ‰§è¡Œæ„å»º</li>
<li>è¿è¡Œæ‰€æœ‰æµ‹è¯•</li>
</ul>

<p>æˆ‘æ¨èé˜…è¯»<a href="https://docs.github.com/en/actions/learn-github-actions" rel="nofollow"> GitHubçš„æ–‡æ¡£</a>æ¥äº†è§£æ›´å¤šã€‚è¿™ç¯‡åšæ–‡å‡è®¾æ‚¨ç†Ÿæ‚‰ä½¿ç”¨GitHubæ“ä½œæ„å»ºå·¥ä½œæµçš„åŸºç¡€çŸ¥è¯†ã€‚</p>

<h2 id="getting-started-with-github-actions-for-octopus-deploy">Octopus Deployçš„GitHubæ“ä½œå…¥é—¨</h2>

<p>ä¸ºäº†è¯´æ˜å¦‚ä½•ä¸ºOctopusä½¿ç”¨æ–°çš„GitHubæ“ä½œï¼Œæˆ‘ä»¬å°†æ›´æ–°ä¸Šé¢çš„ç¤ºä¾‹æ„å»ºè„šæœ¬ï¼Œä»¥å®‰è£…Octopus CLIï¼Œæ‰“åŒ…æˆ‘ä»¬çš„æ„å»ºå·¥ä»¶å¹¶å°†å…¶æ¨é€åˆ°Octopusï¼Œç„¶ååˆ›å»ºä¸€ä¸ªå‘å¸ƒå¹¶å°†å…¶éƒ¨ç½²åˆ°æˆ‘ä»¬çš„å¼€å‘ç¯å¢ƒä¸­ã€‚</p>

<p>å®Œæ•´çš„å·¥ä½œæµæ–‡ä»¶å¯ä»¥åœ¨<a href="https://github.com/OctopusSamples/RandomQuotes/actions/workflows/dotnet.yml" rel="nofollow"> GitHubç¤ºä¾‹åº“</a>ä¸­æ‰¾åˆ°:</p>

<pre><code class="language-yaml">name: Build

on:
  push:
    branches: [ master ]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Setup .NET
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: 5.0.x
    - name: Restore dependencies
      run: dotnet restore
    - name: Build
      run: dotnet publish -o build 
    - name: Test
      run: dotnet test --no-build --verbosity normal
    - name: Install Octopus CLI ğŸ™
      uses: OctopusDeploy/install-octopus-cli-action@v1.1.6
      with:
        version: latest
    - name: Package build artifacts
      run: octo pack --id="RandomQuotes" --format="zip" --version="1.0.${{github.run_number}}" --basePath="/home/runner/work/RandomQuotes/RandomQuotes/build/"
    - name: Push packages to Octopus Deploy ğŸ™
      uses: OctopusDeploy/push-package-action@v1.0.1
      with:
        api_key: ${{ secrets.OCTOPUS_APIKEY }}
        server: ${{ secrets.OCTOPUS_SERVER }}
        packages: "RandomQuotes.1.0.${{github.run_number}}.zip"
    - name: Create a release in Octopus Deploy ğŸ™
      uses: OctopusDeploy/create-release-action@v1.0.2
      with:
        api_key: ${{ secrets.OCTOPUS_APIKEY }}
        server: ${{ secrets.OCTOPUS_SERVER }}
        project: "Projects-141"
        deploy_to: "Dev"

</code></pre>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-06/github-actions-for-octopus-deploy/github-action-secrets.png" class="zoom" data-title=""><img src="../Images/eea88e63caa0d2885dc368ec131fbe5c.png" class="img-fluid center" alt="GitHub Actions Secrets for the Octopus Server URL and an API key" data-original-src="https://i.octopus.com/blog/2021-06/github-actions-for-octopus-deploy/github-action-secrets.png"/></a>T2ã€‘</p>

<p>æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªé…ç½®ä¸­å¼•ç”¨äº†ä¸¤ä¸ªç§˜å¯†ã€‚ä¸€ä¸ªæ˜¯OctopusæœåŠ¡å™¨URLï¼Œå¦ä¸€ä¸ªæ˜¯APIå¯†é’¥ï¼Œç”¨äºéªŒè¯å’Œé›†æˆOctopuså®ä¾‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ä¸€ä¸ª<a href="https://octopus.com/docs/octopus-cloud"> Octopusäº‘å®ä¾‹</a>ï¼Œç„¶è€Œï¼Œå¦‚æœå®ƒæ˜¯å¯å…¬å¼€è®¿é—®çš„ï¼Œä½ ä¹Ÿå¯ä»¥è¿æ¥åˆ°ä¸€ä¸ª<a href="https://octopus.com/docs/getting-started#self-hosted-octopus">è‡ªæ‰˜ç®¡Octopuså®ä¾‹</a>ã€‚</p>

<p>æ³¨æ„:è¿™æ˜¯å»ºç«‹ä¸€ä¸ªå¾®è½¯ã€‚NET 5 webåº”ç”¨ç¨‹åºï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯Spring (Java) webåº”ç”¨ç¨‹åºæˆ–NodeJS expressæœåŠ¡ç­‰ã€‚é‡è¦çš„éƒ¨åˆ†æ˜¯GitHubå¯¹Octopusçš„æ“ä½œå¦‚ä½•ä½¿é›†æˆå˜å¾—å®¹æ˜“ã€‚</p>


<h3 id="installing-the-octopus-cli">å®‰è£…Octopus CLI</h3>

<pre><code class="language-yaml">    - name: Install Octopus CLI ğŸ™
      uses: OctopusDeploy/install-octopus-cli-action@v1.1.6
      with:
        version: latest
</code></pre>

<p>è¦ä¸OctopusæœåŠ¡å™¨é›†æˆï¼Œé¦–å…ˆå®‰è£…Octopus CLIã€‚è¿™æ˜¯ä½¿ç”¨ä»»ä½•å…¶ä»–æ­¥éª¤çš„å…ˆå†³æ¡ä»¶ï¼Œå› ä¸ºå®ƒä¼šä½¿ç”¨é€‚å½“çš„ä¾èµ–é¡¹å¼•å¯¼ä½œä¸šè¿è¡Œå™¨æ¥å®‰è£…Octopus CLIã€‚</p>

<h3 id="pushing-build-artifacts-to-octopus">å°†æ„å»ºå·¥ä»¶æ¨é€åˆ°Octopus</h3>

<pre><code class="language-yaml">    - name: Pack
      run: octo pack --id="RandomQuotes" --format="zip" --version="1.0.${{github.run_number}}" --basePath="/home/runner/work/RandomQuotes/RandomQuotes/build/" --verbose
    - name: Push a package to Octopus Deploy ğŸ™
      uses: OctopusDeploy/push-package-action@v1.0.1
      with:
        api_key: ${{ secrets.OCTOPUS_APIKEY }}
        server: ${{ secrets.OCTOPUS_SERVER }}
        packages: "RandomQuotes.1.0.${{github.run_number}}.zip"
</code></pre>

<p>ä¸‹ä¸€æ­¥æ˜¯æ‰“åŒ…æ‚¨çš„æ„å»ºå·¥ä»¶ï¼Œå¹¶å°†å®ƒä»¬æ¨åˆ°ä¸€ä¸ªåŒ…å­˜å‚¨åº“ä¸­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ­£åœ¨æ¨è¿›Octopuså†…ç½®çš„åŒ…å­˜å‚¨åº“ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¬¢è¿çš„é€‰æ‹©ã€‚</p>

<p>æ‰“åŒ…å’Œæ¨é€æˆ‘çš„æ„å»ºå·¥ä»¶æœ‰ä¸¤ä¸ªæ­¥éª¤:</p>

<ol>
<li>å°†æˆ‘çš„æ„å»ºè¾“å‡ºæ‰“åŒ…ä¸ºZIPæ–‡ä»¶ã€‚</li>
<li>å°†åŒ…æ¨é€åˆ°æˆ‘çš„Octopuså®ä¾‹ã€‚</li>
</ol>

<p>å¦‚å‰æ‰€è¿°ï¼Œæˆ‘å¼•ç”¨äº†å­˜å‚¨åœ¨æˆ‘çš„å­˜å‚¨åº“é…ç½®ä¸­çš„ä¸¤ä¸ªç§˜å¯†ã€‚ä¸€ä¸ªæ˜¯OctopusæœåŠ¡å™¨URLï¼Œå¦ä¸€ä¸ªæ˜¯æˆ‘çš„GitHubæ„å»ºçš„APIå¯†é’¥ã€‚</p>

<h3 id="creating-a-release-and-deploying-it-to-the-dev-environment">åˆ›å»ºä¸€ä¸ªç‰ˆæœ¬å¹¶å°†å…¶éƒ¨ç½²åˆ°å¼€å‘ç¯å¢ƒä¸­</h3>

<pre><code class="language-yaml">    - name: Create a release in Octopus Deploy ğŸ™
      uses: OctopusDeploy/create-release-action@v1.0.2
      with:
        api_key: ${{ secrets.OCTOPUS_APIKEY }}
        server: ${{ secrets.OCTOPUS_SERVER }}
        project: "Projects-141"
        deploy_to: "Dev"
</code></pre>

<p>æˆ‘çš„æ„å»ºè¿‡ç¨‹çš„æœ€åä¸€æ­¥æ˜¯åˆ›å»ºæˆ‘çš„é¡¹ç›®çš„å‘å¸ƒï¼Œå¹¶å°†å…¶éƒ¨ç½²åˆ°æˆ‘çš„å¼€å‘ç¯å¢ƒä¸­ã€‚è¿™æ˜¯ä¸€æ­¥å®Œæˆçš„ï¼›æˆ‘æä¾›äº†æˆ‘çš„é¡¹ç›®IDå’Œæˆ‘æƒ³è¦éƒ¨ç½²åˆ°çš„ç¯å¢ƒåç§°ã€‚ä»…æ­¤è€Œå·²ã€‚</p>

<h3 id="success">æˆåŠŸï¼</h3>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-06/github-actions-for-octopus-deploy/github-build.png" class="zoom" data-title=""><img src="../Images/46d2c530560eb582101bfb3a82831733.png" class="img-fluid center" alt="Successful GitHub build" data-original-src="https://i.octopus.com/blog/2021-06/github-actions-for-octopus-deploy/github-build.png"/>T2ã€‘</a></p>

<p>å¦‚æœæˆ‘ä»¬å‘æˆ‘ä»¬çš„å­˜å‚¨åº“æäº¤ä¸€ä¸ªcommitï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°GitHubåŠ¨ä½œçš„è¿è¡ŒåŠå…¶è¾“å‡ºã€‚å¯èƒ½éœ€è¦å‡ æ¬¡è¿­ä»£æ¥ä¿®æ­£è¯­æ³•å¹¶è·å¾—æ­£ç¡®çš„ç»“æœï¼Œä½†ç»“æœæ˜¯ä¸€ä¸ªæˆåŠŸçš„æ„å»ºã€‚</p>

<h2 id="conclusion">ç»“è®º</h2>

<p>é’ˆå¯¹Octopus Deployçš„GitHubæ“ä½œç°å·²æ¨å‡ºã€‚è¯¥ç‰ˆæœ¬åŒ…æ‹¬å®‰è£…Octopus CLIå’Œå°†åŒ…æ¨é€åˆ°Octopuså®ä¾‹çš„æ“ä½œï¼Œä»¥åŠåˆ›å»ºå’Œéƒ¨ç½²ç‰ˆæœ¬å’Œæ‰§è¡Œæ“ä½œæ‰‹å†Œçš„æ”¯æŒã€‚</p>

<p>æ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨GitHubæ“ä½œè‡ªåŠ¨åŒ–æ‚¨çš„æ„å»ºï¼Œå¹¶ä¸Octopusé›†æˆä»¥æ»¡è¶³æ‚¨æ‰€æœ‰çš„éƒ¨ç½²å’Œrunbookè‡ªåŠ¨åŒ–éœ€æ±‚ã€‚</p>

<p>æˆ‘ä»¬è®¡åˆ’ä¸ºOctopusæ·»åŠ é¢å¤–çš„åŠ¨ä½œã€‚å¦‚æœä½ æƒ³è®©æˆ‘ä»¬æ·»åŠ ä»€ä¹ˆï¼Œè¯·åœ¨è¯„è®ºä¸­å‘Šè¯‰æˆ‘ä»¬ã€‚</p>

<p>æ„‰å¿«çš„éƒ¨ç½²ï¼</p>

                    
                    
</body>
</html>