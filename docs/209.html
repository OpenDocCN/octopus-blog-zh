<html>
<head>
<title>Deploying to IBM WebSphere Liberty - Octopus Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>部署到IBM WebSphere Liberty-Octopus Deploy</h1>
<blockquote>原文：<a href="https://octopus.com/blog/deploying-to-websphere-liberty#2021-08-12">https://octopus.com/blog/deploying-to-websphere-liberty#2021-08-12</a></blockquote>
                        <p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/blogimage-deploying-to-ibm-websphere-liberty-2021.png" class="zoom" data-title=""><img src="../Images/1d7be6777d1b3ebea0353c3a66310a89.png" class="img-fluid center" alt="An Octopus standing by Websphere servers" data-original-src="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/blogimage-deploying-to-ibm-websphere-liberty-2021.png"/>T2】</a></p>

<p>在评估软件时，很容易忽略一个选项，因为它没有列出您使用的特定堆栈。然而，仅仅因为它没有被列出，并不意味着它不受支持。</p>

<p>对于基于Java的应用程序，Octopus Deploy包括了部署到Tomcat和Wildfly (JBoss)的具体步骤。这是两种最流行的选择，但是还有更多web服务器技术可用。</p>

<p>Web服务器，比如Payara和IBM WebSphere Liberty，会在应用程序被放在特定的文件夹中时自动部署它。没有必要为这些特定的服务器类型编写步骤模板。</p>

<p>在本文中，我将演示如何将PetClinic应用程序部署到IBM WebSphere Liberty web服务器上。</p>

<h2 id="ibm-websphere-liberty">IBM WebSphere Liberty</h2>

<p>IBM WebSphere Liberty是一种由IBM开发的基于Java的应用程序的web服务器技术。这个服务器既有<a href="https://www.ibm.com/cloud/websphere-liberty/pricing" rel="nofollow">付费</a>又有<a href="https://openliberty.io/" rel="nofollow">开源</a>变种。当应用程序放在服务器的特定文件夹中时，这两种变体具有相同的自动应用程序部署选项。此外，Liberty可用于Windows和Linux操作系统。在这篇文章中，我使用的是Windows。</p>

<h3 id="set-up">建立</h3>

<p>要安装Liberty，只需下载并解压即可。除了安装Java，这就是设置所需的全部内容。</p>

<h3 id="create-server">创建服务器</h3>

<p>将服务器软件提取到文件夹后，打开终端并导航到<code>bin</code>文件夹。我的情况是<code>c:\wlp\bin</code>。</p>

<p>在那里，运行下面的命令(无论在Windows还是Linux上，这个命令都是一样的):</p>

<pre><code>server create &lt;Name&gt;
</code></pre>

<p>这将在<code>usr\servers</code>文件夹中创建一个您给它起的名字的文件夹。我给我的宠物诊所打了电话(<code>c:\wlp\usr\servers\petclinic</code>)。</p>

<p>运行以下命令启动服务器:</p>

<pre><code>server start &lt;Name&gt;
</code></pre>

<p>最后，在你的自由服务器上安装章鱼触手。</p>

<p>这篇文章假设你对Octopus有一定的了解，但不包括触手安装。</p>

<p>关于如何将Liberty设置为作为服务运行，请参考IBM文档:</p>



<h2 id="octopus-deploy">章鱼部署</h2>

<p>在这个演示中，我将部署Java PetClinic应用程序。这个应用程序使用一个MySQL数据库后端，所以我的部署过程将包括创建数据库(如果不存在)、部署数据库更改以及最后将Java应用程序部署到IBM WebSphere Liberty的步骤。</p>

<h3 id="process">过程</h3>

<p>部署过程包括以下步骤:</p>

<ul>
<li>MySQL:如果数据库不存在，则创建数据库</li>
<li>MySQL:如果不存在，则创建用户</li>
<li>参考包中的飞行路线信息</li>
<li>DBA批准(手动干预步骤)</li>
<li>从引用的包进行快速迁移</li>
<li>将PetClinic部署到WebSphere Liberty</li>
</ul>

<p>这篇文章的重点是部署到IBM WebSphere Liberty，并将涵盖这一步骤。</p>

<h4 id="deploy-a-java-archive">部署Java归档文件</h4>

<p>部署到IBM WebSphere Liberty使用Octopus Deploy的内置步骤<code>Deploy a Java Archive</code>。编辑您的流程并点击<strong>添加步骤</strong>并选择<strong>部署Java归档</strong>:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/octopus-deploy-java-archive.png" class="zoom" data-title=""><img src="../Images/ec12061766970d8b1a9a4d5bf7d4def9.png" class="img-fluid center" alt="" data-original-src="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/octopus-deploy-java-archive.png"/>T2】</a></p>

<p>选择您希望部署的角色和包，并滚动到<strong>部署</strong>部分。选定的包将包含包的版本号。</p>

<p>如果想名字更有用，就填<code>Deployed package file name</code>。在我的例子中，我希望包含环境名，所以我使用了<code>petclinic_#{Octopus.Environment.Name}.war</code>:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/octopus-package-name.png" class="zoom" data-title=""><img src="../Images/87c242737f58ee750fe1b287fd6004df.png" class="img-fluid center" alt="" data-original-src="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/octopus-package-name.png"/>T2】</a></p>

<p>如前所述，如果将应用程序放在名为<strong> dropins </strong>的特定文件夹中，IBM WebSphere Liberty将自动部署该应用程序。<strong> dropins </strong>文件夹直接位于我们之前创建的服务器文件夹之外；<code>c:\wlp\usr\servers\petclinic\dropins</code>。</p>

<p>要将我们的文件放在这个特定的文件夹中，我们需要启用<strong>使用定制部署目录</strong>特性，并指定放在哪里:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/octopus-custom-directory.png" class="zoom" data-title=""><img src="../Images/475d1c5b0ba2aff4be7d509e85aed388.png" class="img-fluid center" alt="" data-original-src="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/octopus-custom-directory.png"/>T2】</a></p>

<p>PetClinic应用程序需要用数据库服务器、用户名和密码细节更新的<code>WEB-INF/classes/spring/datasource-config.xml</code>文件。为此，我们将使用<strong>结构化配置变量</strong>特性。滚动到该步骤的顶部，点击<strong>配置功能</strong>。启用<strong>结构化配置变量</strong>功能，点击<strong>确定</strong>:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/octopus-structured-configuration-variables.png" class="zoom" data-title=""><img src="../Images/f5611109e417961a4263b8aa5a6492ed.png" class="img-fluid center" alt="" data-original-src="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/octopus-structured-configuration-variables.png"/>T2】</a></p>

<p>滚动到刚刚添加到表单的<strong>结构化配置变量</strong>部分，输入<code>WEB-INF/classes/spring/datasource-config.xml</code>作为值:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/octopus-structured-configuration-variables-value.png" class="zoom" data-title=""><img src="../Images/33eaf25943d186e5b683ff5d475fb855.png" class="img-fluid center" alt="" data-original-src="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/octopus-structured-configuration-variables-value.png"/>T2】</a></p>

<p>配置此功能后，定义以下项目变量:</p>

<ul>
<li><code>//*:property[@name='password']/@value</code>:用户账号密码</li>
<li><code>//*:property[@name='username']/@value</code>:MySQL连接的用户名</li>
<li><code>//*:property[@name='url']/@value</code> : JDBC到MySQL的连接字符串</li>
</ul>

<h3 id="deploy">部署</h3>

<p>定义好流程后，我们现在可以将应用程序部署到服务器上了。部署完成后，您应该会看到PetClinic web应用程序部署的以下输出:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/octopus-deployment-complete.png" class="zoom" data-title=""><img src="../Images/2c7d82c792171e9f6b08084dd7c13605.png" class="img-fluid center" alt="" data-original-src="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/octopus-deployment-complete.png"/>T2】</a></p>

<p>WebSphere Liberty的默认端口是<code>9080</code>。导航到<code>http://websphere1:9080/petclinic_Development</code>显示我们的应用程序已经部署:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/websphere-petclinic.png" class="zoom" data-title=""><img src="../Images/aae92b2aab9b4d3cf4c5b897ae7c8d7d.png" class="img-fluid center" alt="" data-original-src="https://i.octopus.com/blog/2021-05/deploying-to-websphere-liberty/websphere-petclinic.png"/>T2】</a></p>

<h2 id="conclusion">结论</h2>

<p>在这篇文章中，我展示了将基于Java的应用程序部署到IBM WebSphere Liberty web服务器是多么容易。希望这有帮助。</p>

<p>愉快的部署！</p>

                    
                    
</body>
</html>