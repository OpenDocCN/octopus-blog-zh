# 詹金斯安全提示-章鱼部署

> 原文：<https://octopus.com/blog/jenkins-security-tips>

对于这样一个开放的、可定制的平台，Jenkins 即使在默认状态下也能提供不错的安全性。鉴于它连接到无数的行业工具(包括 Octopus)，尽管如此，还有一些其他的方法来帮助保护您的项目。

在本帖中，我们将探讨一些方法和工具来保证 Jenkins 实例的安全，并保护使用它的人。

## 保持一切更新

[正如 2021 年 12 月提醒我们的](https://octopus.com/blog/octopus-deploy-log4j-response)，软件漏洞随时都会暴露出来。软件提供商不仅更新他们的应用程序来修复错误或添加新功能，而且还消除安全漏洞。

Jenkins 有一个安全咨询页面让你了解他们平台的漏洞。然而，保持你的实例更新仍然是一个好主意，包括它的插件。

要在 Jenkins 中检查更新:

1.  从菜单中点击**管理詹金斯**。
2.  **Manage Jenkins** 屏幕会在顶部告诉你是否有新版本。点击**或自动升级**按钮立即升级。否则，您可以下载最新版本并在预定时间升级。

您也可以从同一个屏幕回滚升级——只需点击**降级**按钮。

要更新 Jenkins 插件:

1.  从菜单中点击**管理詹金斯**。
2.  点击**管理插件**。
3.  确保你在**更新**标签上，勾选你想要安装的更新，点击**立即下载，重启后安装**。
4.  重启 Jenkins 以完成更新。

你可以在大多数主流操作系统和容器上安装 Jenkins，所以也要保持更新。有关如何操作的更多信息，请查阅您的操作系统文档。

## 只有在你确定的情况下才更改 Jenkins 的安全默认值

Jenkins 在安装时启用了它的大部分安全功能，以尽可能确保安全。尽管有很多方法可以使用 Jenkins，但对于如何最好地配置或锁定您的实例，并没有“一刀切”的方法。

因此，虽然我们不能提供对您的团队最有利的建议(我们接下来将探讨一个例外)，Jenkins 提供了您应该关注的重要特性的详细文档。请参见[保护 Jenkins 页面](https://www.jenkins.io/doc/book/security/)获取与以下内容相关的安全帮助:

*   基本设置
*   构建行为
*   用户界面

您应该在仔细考虑后做出更改，如果可能的话，与您的网络安全专家交谈。您可以在**配置全球安全**页面中进行这些更改——从左侧菜单中选择**管理 Jenkins** 即可找到。

## 避免在控制器上构建

Jenkins 提供了一个内置节点，因此您可以尽快运行测试，看看它是否适合您。但是，在单个实例上运行的构建可以访问操作系统的文件系统。出于这个原因，Jenkins 建议您让作业在“代理”上运行(这发生在可伸缩的设置中，我们在上一篇文章[中讨论过，在 Jenkins](https://octopus.com/blog/jenkins-dynamic-build-agents) 中使用动态构建代理来自动伸缩)。

代理是运行作业而不是控制器的虚拟 Jenkins 实例。使用代理时，您可以阻止控制器运行内部版本，以限制对可能有害的文件的访问。

若要停止控制器运行构件:

1.  从菜单中点击**管理詹金斯**。
2.  点击**管理节点和云**。
3.  点击**内置节点**右侧的齿轮。
4.  您有两个选项来防止控制器上的构建。选择一个并点击**保存**:
    *   如果您不想在控制器上构建，请将**执行器数量**更改为 **0** 。
    *   如果您想在需要时在控制器上构建，从**用法**下拉菜单中选择**仅构建标签表达式与此节点**匹配的作业。

## 仅允许您的团队访问他们需要的内容

安全不仅仅是保护自己免受外来威胁。这也是为了从内部保护你的环境，因为事故可能会发生。在以下情况下，它们更有可能发生:

*   您正在使用单个管理员帐户运行 Jenkins 实例
*   每个人都可以接触到任何东西
*   人们可以改变他们不应该改变的事情

这里有一些管理用户访问的建议。

### 给每个 Jenkins 用户一个帐户

为了帮助跟踪您的用户正在做什么，为使用您的 Jenkins 实例的任何人创建个人用户帐户。这样你可以看到所有的活动和谁做了什么。

要创建额外用户:

1.  从菜单中点击**管理詹金斯**。
2.  向下滚动并选择**管理用户**。
3.  点击左侧的**创建用户**。
4.  填写所有字段并点击**创建用户**。

### 使用矩阵授权策略插件

我们建议使用[矩阵授权策略插件](https://plugins.jenkins.io/matrix-auth/)在更精细的层面上管理用户对 Jenkins 的访问。例如，使用这个插件，您可以:

*   限制用户的访问权限，使他们只能查看和管理他们所属项目的内部版本
*   授予项目经理只读访问权限，以便他们可以看到构建的进展情况

要安装插件:

1.  从左侧菜单中点击**管理詹金斯**。
2.  点击**管理插件**。
3.  点击**可用的**标签，开始输入`Matrix Authorization`。插件会出现在预测结果中。
4.  勾选插件左侧的方框，点击**安装，无需重启**。

要使用插件设定权限:

1.  从菜单中点击**管理詹金斯**。
2.  点击**配置全局安全**。
3.  单击以下任一选项的单选按钮:
    *   **基于矩阵的安全性**–允许您管理全局用户和组权限。
    *   **基于项目的矩阵授权策略**–允许您在项目级别管理用户和组权限。
4.  无论您的选择如何，请使用按钮添加用户或组，并使用表中的复选框选择他们的访问级别。完成后点击**保存**。

### 您应该考虑的其他用户访问插件

如果您已经使用其他系统进行访问管理，那么您可以使用这些系统来验证您的 Jenkins 用户。例如，微软的 Active Directory 和 OpenID 都有插件，这样你就不用在多个地方管理访问了。

我们还建议查看[文件夹](https://plugins.jenkins.io/cloudbees-folder/)和[基于文件夹的授权策略](https://plugins.jenkins.io/folder-auth/)插件。

文件夹插件允许您在嵌套的文件夹中对作业进行分组。这个插件可以让你对共享安全需求的任务进行分组，这有助于你更密切地关注它们。

基于文件夹的授权策略插件通过让您使用角色设置文件夹访问权限，扩展了文件夹的安全性。

## 安全存储您的凭据

[凭证绑定插件](https://plugins.jenkins.io/credentials-binding/)是加密和安全存储连接 Jenkins 和其他服务的凭证的最佳选择。Jenkins 也推荐它——作为他们第一次安装 Jenkins 时推荐的插件之一。另外，许多其他插件把它作为一种依赖。

此插件允许您存储和重用所有类型的身份验证方法，例如:

*   用户名和密码
*   SSH 用户名和私钥
*   秘密文件
*   秘密文本
*   证书

我们将在以后的文章中详细介绍凭证绑定插件。

## 结论

正如您所看到的，有很多方法可以确保安全地使用 Jenkins 来保护项目免受外部和内部的风险。查看 [Jenkins 的文档](https://www.jenkins.io/doc/book/security/)，了解更多关于保护实例安全的信息。

查看我们关于配置 Jenkins 的其他帖子:

尝试我们免费的 Jenkins 管道生成器工具用 Groovy 语法创建一个管道文件。这是您启动管道项目所需的一切。

## 观看我们的詹金斯管道网络研讨会

[https://www.youtube.com/embed/D_7AHTML_xw](https://www.youtube.com/embed/D_7AHTML_xw)

VIDEO

我们定期举办网络研讨会。请参见[网络研讨会第](https://octopus.com/events)页，了解有关即将举办的活动和实时流媒体录制的详细信息。

阅读我们的[持续集成系列](https://octopus.com/blog/tag/CI%20Series)的其余部分。

愉快的部署！