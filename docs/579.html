<html>
<head>
<title>Escaping the pipe character in PowerShell commands - Octopus Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在PowerShell命令中转义管道字符- Octopus Deploy</h1>
<blockquote>原文：<a href="https://octopus.com/blog/powershell-pipe-escaping#2021-08-12">https://octopus.com/blog/powershell-pipe-escaping#2021-08-12</a></blockquote>
                        <p><a href="#" data-featherlight="https://i.octopus.com/blog/2019-12/powershell-pipe-escaping/powershell-escape-pipe-character.png" class="zoom" data-title=""><img src="../Images/b719f3da8052dcfd4fe8647d670d89c9.png" class="img-fluid center" alt="Escaping the pipe character in PowerShell commands" data-original-src="https://i.octopus.com/blog/2019-12/powershell-pipe-escaping/powershell-escape-pipe-character.png"/>T2】</a></p>

<p>最近，我的任务是开发一些Azure web应用程序，为了节省时间，我使用Azure CLI来运行命令<code>az webapp create -g testgroup -p testplan -n testapp --runtime "node|10.6"</code>。这导致了非常迟钝的错误<code>'10.6' is not recognized as an internal or external command, operable program or batch file.</code>，我花了一些谷歌来理解这个问题。PowerShell转义字符没有按照我预期的方式提供帮助。</p>

<p>在这篇博文中，我们将看看解决这个错误的一些方法。</p>

<h2 id="wrap-the-string-with-quotes">用引号将字符串括起来</h2>

<p>解决此错误的第一种方法是用单引号将包含管道字符的字符串括起来，如下所示:</p>

<pre><code class="language-PowerShell">az webapp create -g testgroup -p testplan -n testapp --runtime '"node|10.6"'
</code></pre>

<p>或者:</p>

<pre><code class="language-PowerShell">az webapp create -g testgroup -p testplan -n testapp --runtime 'node"|"10.6'
</code></pre>

<p>您也可以用转义双引号将字符串括起来:</p>

<pre><code class="language-PowerShell">az webapp create -g testgroup -p testplan -n testapp --runtime "`"node|10.6`""
</code></pre>

<p>这也适用于<code>Start-Process</code> CmdLet:</p>

<pre><code class="language-PowerShell">start-process az -argumentlist @("webapp", "create", "-g", "testgroup", "-p", "testplan", "-n", "testapp", "--runtime", '"node|10.6"') -nonewwindow -wait
</code></pre>

<p>您可以在外部变量中定义参数，并用引号将管道字符括起来:</p>

<pre><code class="language-PowerShell">$runtime='node"|"10.6'
az webapp create -g testgroup -p testplan -n testapp --runtime $runtime
</code></pre>

<h2 id="use-the-powershell-stop-parsing-symbol">使用PowerShell停止解析符号</h2>

<p>可以将停止解析符号(- %)添加到命令中，以指示PowerShell停止尝试解释字符串，从而生成类似以下的命令:</p>

<pre><code class="language-PowerShell">az webapp create -g testgroup -p testplan -n testapp --runtime --% "node|10.6"
</code></pre>

<p>您可以在<a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_parsing?view=powershell-6" rel="nofollow"> PowerShell文档</a>中找到关于此符号的更多信息。</p>

<h2 id="what-doesnt-work">什么不起作用</h2>

<p>用单引号括住管道字符不起作用:</p>

<pre><code class="language-PowerShell">PS C:\Users\Matthew&gt; az webapp create -g testgroup -p testplan -n testapp --runtime "node'|'10.6"
''10.6' is not recognized as an internal or external command,
operable program or batch file.
</code></pre>

<p>使用单引号不起作用:</p>

<pre><code class="language-PowerShell">PS C:\Users\Matthew&gt; az webapp create -g testgroup -p testplan -n testapp --runtime 'node|10.6'
'10.6' is not recognized as an internal or external command,
operable program or batch file.
</code></pre>

<p>将运行时字符串放入变量是行不通的:</p>

<pre><code class="language-PowerShell">PS C:\Users\Matthew&gt; $runtime = "node|10.6"
PS C:\Users\Matthew&gt; az webapp create -g testgroup -p testplan -n testapp --runtime $runtime
'10.6' is not recognized as an internal or external command,
operable program or batch file.
</code></pre>

<p>使用<code>Start-Process</code>也不起作用:</p>

<pre><code class="language-PowerShell">PS C:\Users\Matthew&gt; start-process az -argumentlist @("webapp", "create", "-g", "testgroup", "-p", "testplan", "-n", "testapp", "--runtime", "node|10.6") -nonewwindow -wait
'10.6' is not recognized as an internal or external command,
operable program or batch file.
</code></pre>

<p>转义竖线字符不起作用:</p>

<pre><code class="language-PowerShell">PS C:\Users\Matthew&gt; az webapp create -g testgroup -p testplan -n testapp --runtime "node`|10.6"
'10.6' is not recognized as an internal or external command,
operable program or batch file.
</code></pre>

<p>使用PowerShell转义字符<code>^</code>不起作用。这是您在Windows命令提示符下转义管道字符的方式，我曾看到它被错误地建议作为PowerShell的解决方案:</p>

<pre><code class="language-PowerShell">PS C:\Users\Matthew&gt; az webapp create -g testgroup -p testplan -n testapp --runtime "node^|10.6"
'10.6' is not recognized as an internal or external command,
operable program or batch file.
</code></pre>

<h2 id="conclusion">结论</h2>

<p>在PowerShell中使用管道字符传递参数需要一些特殊的处理，这并不是显而易见的，但是停止处理符号或一些特殊的带引号的转义将会使您摆脱麻烦。</p>

                    
                    
</body>
</html>