<html>
<head>
<title>Building the Octopus CLI vNext - Octopus Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>构建Octopus CLI vNext - Octopus Deploy</h1>
<blockquote>原文：<a href="https://octopus.com/blog/building-octopus-cli-vnext#2022-10-11">https://octopus.com/blog/building-octopus-cli-vnext#2022-10-11</a></blockquote>
                        <p>Octopus命令行界面(CLI)多年来为我们提供了很好的服务。然而，它有一些我们想要解决的限制。</p>

<p>在这篇文章中，我分享了我们用Octopus Deploy改进CLI体验的计划。</p>

<h2 id="the-state-of-the-octopus-cli-octo">Octopus CLI的状态(octo)</h2>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-10/building-octopus-cli-vnext/octo.png" class="zoom" data-title=""><img src="../Images/01399bf571d8d4217cba5b273aa7e981.png" class="img-fluid center" alt="Screenshot of Octopus CLI (octo)" data-original-src="https://i.octopus.com/blog/2022-10/building-octopus-cli-vnext/octo.png"/>T2】</a></p>

<p><a href="https://github.com/OctopusDeploy/OctopusCLI" rel="nofollow"> Octopus CLI </a> ( <code>octo</code>)建立在C#之上，并且严重依赖<a href="https://github.com/OctopusDeploy/OctopusClients" rel="nofollow">Octopus client</a>。NET库。它提供命令来促进部署和runbook执行的自动化。值得注意的命令包括:</p>

<ul>
<li><code>build-information</code></li>
<li><code>create-release</code></li>
<li><code>deploy-release</code></li>
<li><code>pack</code></li>
<li><code>push</code></li>
<li><code>run-runbook</code></li>
</ul>

<p>Octopus CLI仍然是与<a href="https://octopus.com/docs/octopus-rest-api"> Octopus REST API </a>交互的最有效方式之一。它使我们的客户能够自动执行重复性任务，同时提供执行一次性命令的灵活性。我们为支持的平台构建和维护的大多数集成，如Azure DevOps、GitHub Actions和TeamCity，都使用它来执行与<a href="https://octopus.com/docs/octopus-rest-api"> Octopus REST API </a>一致的操作。</p>

<p>尽管Octopus CLI多年来为我们提供了很好的服务，但我们希望解决它的一些局限性:</p>

<ul>
<li><strong>为自动化而建，而不是为人而建:</strong>当你使用Octopus CLI时，你可以看出它主要是作为一个自动化工具而建的。CLI需要不断发展，以包含以人为本的设计。</li>
<li><strong>命令结构和输出不一致:</strong>Octopus CLI命令结构不一致是由于这些年来添加的命令。产出不是由总体战略决定的。在命令结构中有一些明显的例外会损害一致性，例如<code>pack</code>。此外，这些命令是按操作而不是按目标资源分组的。这损害了整体用户体验，并使命令集的发展变得困难。</li>
<li><strong>运行时依赖:</strong>尽管Octopus CLI是一个自包含的可执行文件，但它要求在运行二进制文件之前必须安装平台库(例如，依赖于。Alpine上的. NET自包含可执行文件)。这反映在用于各种Linux发行版的Octopus CLI vNext所需的安装脚本中。</li>
<li><strong>跨平台编译困难:</strong>构建脚本与Nuke捆绑在一起，需要Windows专用工具(即<code>SignTool.exe</code>)，这使得构建跨平台变得困难。例如，参见<a href="https://github.com/OctopusDeploy/OctopusCLI/issues/124" rel="nofollow">问题#124，macOS构建失败</a>。</li>
<li><strong>不支持执行API:</strong>Octopus CLI(<code>octo</code>)不支持这些操作，添加对这些操作的支持需要大量代码路径(有关更多信息，请阅读我们的帖子<a href="https://octopus.com/blog/faster-deployments-with-the-executions-api">使用执行API加快部署</a>)</li>
<li><strong>缺乏自助故障排除:</strong>Octopus CLI(<code>octo</code>)不支持内置功能，让客户排除网络连接问题等故障(参见<a href="https://github.com/OctopusDeploy/OctopusCLI/issues/220" rel="nofollow">问题#220 </a>)。</li>
</ul>

<p>我们纠结于是否继续构建Octopus CLI的功能，并加入我们想要做出的改变以推动事情向前发展。经过仔细考虑，我们决定重新开始，不再受Octopus CLI 10多年设计决策的约束。这个决定也减轻了更新Octopus CLI的挑战，并使我们暴露于现有集成的下游问题。我们希望更有主见，专注于以客户为中心的工作流，我们经常遵从我们的API。</p>

<h2 id="introducing-the-new-octopus-cli-octopus">介绍新的八达通CLI(八达通)</h2>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-10/building-octopus-cli-vnext/new-octopus-cli.png" class="zoom" data-title=""><img src="../Images/9331aead675addc9b9fc0f2983b4c799.png" class="img-fluid center" alt="New Octopus CLI" data-original-src="https://i.octopus.com/blog/2022-10/building-octopus-cli-vnext/new-octopus-cli.png"/>T2】</a></p>

<p>新的Octopus CLI ( <code>octopus</code>)代表了Octopus CLI的发展。首先，可用命令的数量将显著增加。新的Octopus CLI将支持管理资源的操作，如帐户、生命周期、项目和空间。它还将具有用户交互的新功能——我们是提倡这种功能的<a href="https://clig.dev/" rel="nofollow">命令行界面指南</a>的支持者。此功能旨在通过一系列问题来指导用户以最简单的方式执行他们想要的操作:</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-10/building-octopus-cli-vnext/demo-create-release.gif" class="zoom" data-title=""><img src="../Images/a851c5f46e5169533a9f6eb66f7624f1.png" class="img-fluid center" alt="Demo: Create Release with Octopus CLI vNext" data-original-src="https://i.octopus.com/blog/2022-10/building-octopus-cli-vnext/demo-create-release.gif"/>T2】</a></p>

<p>交互式CLI将引导新手和有经验的用户找到他们想要的结果。也就是说，新的Octopus CLI将支持自动化作为其主要用例。</p>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-10/building-octopus-cli-vnext/demo-release-deploy.gif" class="zoom" data-title=""><img src="../Images/64e086a4996ab186154d8b6e623a5c4f.png" class="img-fluid center" alt="Demo: Deploy Release with Octopus CLI vNext" data-original-src="https://i.octopus.com/blog/2022-10/building-octopus-cli-vnext/demo-release-deploy.gif"/>T2】</a></p>

<p>新的Octopus CLI基于Go编程语言。该语言及其支持库非常适合构建CLI。我们还想利用这个机会改进Octopus Deploy 的<a href="https://github.com/OctopusDeploy/go-octopusdeploy" rel="nofollow"> Go API客户端，它是Octopus Deploy </a>的<a href="https://github.com/OctopusDeployLabs/terraform-provider-octopusdeploy" rel="nofollow"> Terraform提供者的基础。</a></p>

<h2 id="why-use-go-to-build-a-cli">为什么使用Go构建CLI？</h2>

<p>Go是一种高度并发的语言，非常适合构建CLI。Octopus Deploy 的<a href="https://github.com/OctopusDeploy/go-octopusdeploy" rel="nofollow"> Go API客户端也是为了支持Octopus Deploy </a>的<a href="https://github.com/OctopusDeployLabs/terraform-provider-octopusdeploy" rel="nofollow"> Terraform Provider而构建的。它已经通过了考验。</a></p>

<p>最后，通过基于C++的多平台支持，Go有助于减少运行时内存占用。这提供了较小的可执行文件大小和对目标环境的少量要求——这结合起来支持客户希望通过<code>curl</code>将CLI与Bash(例如)一起使用的场景。</p>

<h2 id="we-need-your-help">我们需要你的帮助</h2>

<p>我们希望构建一个客户喜欢使用的CLI，因此我们非常感谢您的反馈。我们希望听到您希望我们支持的场景。</p>

<p><span> <a class="btn btn-success" href="https://octopusdeploy.typeform.com/to/COaNc9A3">提供反馈</a> </span></p>

<p>您可以通过GitHub 上的<a href="https://github.com/OctopusDeploy/cli" rel="nofollow"> cli资源库来跟踪我们构建CLI的进度。请随时关注或启动存储库进行更新。我们也开始向流行的软件包库如Chocolatey和Homebrew发布可分发的版本。</a></p>

<p>愉快的部署！</p>

                    
                    
</body>
</html>