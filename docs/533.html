<html>
<head>
<title>Octopus 2022 Q1: Config as Code for deployments - Octopus Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>章鱼2022 Q1:配置为部署代码-章鱼部署</h1>
<blockquote>原文：<a href="https://octopus.com/blog/octopus-release-2022-q1#2022-09-20">https://octopus.com/blog/octopus-release-2022-q1#2022-09-20</a></blockquote>
                        <p>章鱼2022 Q1版现已发售。</p>

<p>我们很高兴分享这种配置作为代码(配置作为代码)部署是普遍可用的。您可以创建受版本控制的项目，并在应用程序代码旁边的Git repo中查看您的部署过程，并一起发展它们。</p>

<p>我们相信我们不折不扣的解决方案是最好的“代码”实现之一。Octopus中的Config as代码提供了Git(分支、提交和历史)的能力和Octopus UI的可用性。Octopus Cloud上提供了Config as代码，可供我们的自助客户下载。</p>

<p>此版本还包括其他值得注意的更新:</p>

<ul>
<li>带有Octopus配置语言(OCL)语法突出显示、代码片段和导航树的Visual Studio代码扩展</li>
<li>更新了Terraform提供程序，支持版本控制项目</li>
<li>新集成:<ul>
<li>Buildkite插件(早期访问)允许您的构建代理创建和部署版本，推送构建信息，并作为管道的一部分运行runbooks</li>
<li>通过集成，您可以将Octopus连接到其他DevOps工具，无需代码自动化</li>
<li>Octopus现在支持连接到多个组织</li>
<li>用最新的Log4j安全补丁更新了<a href="https://www.jetbrains.com/teamcity/" rel="nofollow"> TeamCity </a>插件</li>
</ul>
</li>
<li>使用我们的下一代步骤包框架构建的自动步骤更新和步骤发现</li>
<li>Octopus Deploy收购了Dist技术</li>
</ul>

<h2 id="included-in-the-q1-release">包括在Q1版本中</h2>

<ul>
<li>章鱼服务器2022.1 ( <a href="https://octopus.com/downloads/whatsnew/2022.1">发布说明</a>)</li>
<li>Octopus为Visual Studio部署代码0.0.17</li>
<li>Azure DevOps插件5.0.57</li>
<li>用于Octopus Deploy 6.1.12的团队城市插件</li>
<li>触手6.1.1320</li>
<li>Octopus部署0.7.69的Terraform提供程序</li>
</ul>

<h2 id="long-term-support">长期支持</h2>

<p>下表显示了具有长期支持的Octopus服务器版本。</p>

<table class="table">
<thead>
<tr>
<th>释放；排放；发布</th>
<th>长期支持</th>
</tr>
</thead>
<tbody>
<tr>
<td>八达通2022.1</td>
<td>是</td>
</tr>
<tr>
<td>八达通2021.3</td>
<td>是</td>
</tr>
<tr>
<td>章鱼2021.2</td>
<td>期满</td>
</tr>
</tbody>
</table>

<h2 id="config-as-code-demo">配置为代码演示</h2>

<iframe src="https://www.youtube.com/embed/tHdAsY_7CqA" frameborder="0" allowfullscreen="">VIDEO</iframe>

<h2 id="config-as-code-in-octopus">配置为Octopus中的代码</h2>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/cac-branch-selector.png" class="zoom" data-title=""><img src="../Images/fdc07daa458ed8d6d54e3280b5944e27.png" class="img-fluid center" alt="Octopus Config as Code branch selector" data-original-src="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/cac-branch-selector.png"/>T2】</a></p>

<p>当您为项目启用Config as Code时，您可以像往常一样继续使用Octopus UI，或者您可以在您喜欢的编辑器中编辑文本文件。在你效率最高的地方工作。</p>

<p>配置为代码一直是我们的客户的最大要求之一。在2021年12月发布<a href="https://octopus.com/blog/config-as-code-eap">早期访问预览版后，您的反馈使我们能够在正式发布前进一步调整它。</a></p>

<p>我们设计了我们的解决方案来<a href="https://octopus.com/blog/shaping-config-as-code#anti-patterns">避免关键的反模式</a>，包括错误的配置文件格式、作为简单数据库的Git，以及如果您选择将Config作为代码支持，则完全禁用UI。</p>

<h2 id="customers-using-config-as-code">将配置用作代码的客户</h2>

<p><a href="https://stackoverflow.com" rel="nofollow"> Stack Overflow </a>和<a href="https://recruitwizard.com.au" rel="nofollow"> Recruit Wizard </a>已经在早期访问中使用Config作为代码，并分享了关于它如何改进他们的开发工作流程的反馈。</p>

<blockquote class="blockquote">
<p>它使我们能够将配置代码作为标准。构建管道在软件回购中。部署管道在软件报告中。我们可以做一次公关，我可以改变软件，改变它的构建和部署方式。</p>
</blockquote>

<p>- Chris Hunt，StackOverflow的员工现场可靠性工程师</p>

<p><a href="https://i.octopus.com/case-studies/stack-overflow-case-study-2022.pdf" rel="nofollow">阅读更多</a>关于Stack Overflow如何使用Octopus Deploy和Config作为代码。</p>

<blockquote class="blockquote">
<p>将配置分支为代码允许我们在修改代码的同时修改部署过程。这是一个绝对的游戏改变者，尤其是当我们在团队中加入越来越多的工程师时。</p>
</blockquote>

<p>-本·麦克弗森，招聘向导的首席技术官</p>

<p><a href="https://i.octopus.com/case-studies/recruit-wizard-case-study-2022.pdf" rel="nofollow">阅读更多</a>关于招聘向导如何使用Octopus Deploy和Config作为代码。</p>

<h2 id="why-use-config-as-code">为什么使用配置作为代码？</h2>

<h3 id="branch-your-code-and-deployments">对代码和部署进行分支</h3>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/cac-create-branch.png" class="zoom" data-title=""><img src="../Images/225ff016f196a9afcbf651102186ff03.png" class="img-fluid center" alt="Octopus Config as Code create new branch from branch selector" data-original-src="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/cac-create-branch.png"/>T2】</a></p>

<p>分支是Git的超能力，我们公开这种能力。使用Config作为代码，您可以:</p>

<ul>
<li>在Octopus UI或您喜欢的Git客户端中切换分支，或者创建新的分支</li>
<li>在分支上提交对部署流程的更改</li>
<li>当您更改您的部署过程时，添加(可选)提交消息，以便其他人了解它为什么更改</li>
<li>从您的分支创建发布，并部署以测试您的更改，以支持您的部署过程的许多版本</li>
<li>安全地发展您的部署，无需担心破坏其他团队的部署</li>
<li>如果出现问题，回滚到部署过程的前一个版本</li>
</ul>

<h3 id="review-approve-and-merge">审阅、批准和合并</h3>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/cac-pull-request.png" class="zoom" data-title=""><img src="../Images/e1b16189c09e10f7e8cf8cd15e798c8f.png" class="img-fluid center" alt="Octopus Config as Code - Pull request with application changes and deployment process changes side by side" data-original-src="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/cac-pull-request.png"/></a>T2】</p>

<p>在部署到生产环境之前，检查、批准和合并您的分支。让更多人关注变化总是一件好事。</p>

<p>拉请求、受保护的分支和代码所有者启用了一组新的工作流来提高您的发布的质量和安全性。减少不良部署造成的停机时间，并提高发布的质量。</p>

<h3 id="audit-and-traceability">审计和可追溯性</h3>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/cac-github-history.png" class="zoom" data-title=""><img src="../Images/406784d8b27c73860fc9e41f483ad1a6.png" class="img-fluid center" alt="Octopus Config as code - GitHub deployment process file history" data-original-src="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/cac-github-history.png"/>T2】</a></p>

<p>提交历史改进了对部署过程的变更的可追溯性。知道什么改变了，什么时候，由谁改变的，最重要的是为什么。</p>

<p>不再需要通过搜索审计日志来找出配置更改的原因。Git历史和差异提供了清晰的可追溯性，并讲述了完整的故事。Octopus甚至在Git历史中记录提交者的详细信息。</p>

<h3 id="shared-git-credentials">共享Git凭据</h3>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/cac-shared-git-credentials.png" class="zoom" data-title=""><img src="../Images/54508c4f9784bd209ce9a0250ccd9dfe.png" class="img-fluid center" alt="Octopus Config as Code - Shared Git credentials" data-original-src="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/cac-shared-git-credentials.png"/>T2】</a></p>

<p>从单个视图中重用和管理受版本控制的项目的Git凭证，从而更容易更新令牌并查看它们的使用情况。</p>

<h3 id="scale-your-deployments-across-teams">跨团队扩展您的部署</h3>

<p>从分支创建发布，并独立于其他分支部署您的更改。这允许您支持部署过程的多个版本。您可以安全地发展您的部署，而不用担心破坏其他团队的部署。如果出现问题，您还可以回滚到部署过程的前一个版本。</p>

<hr/>

<p>虽然Config as Code的第一个版本只包括部署过程，但我们正在努力增加对版本控制变量和runbooks的支持。我们还想更新OCL模式，使其更便于手工编辑。</p>

<p>阅读我们的文档来学习如何创建你的第一个版本控制项目。</p>

<h2 id="visual-studio-code-plugin-with-ocl-highlighting-code-snippets-and-navigation-tree">具有OCL突出显示、代码片段和导航树的Visual Studio代码插件</h2>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/octopus-deploy-vs-code-extension-ocl.png" class="zoom" data-title=""><img src="../Images/36a6e64c059d1179b804921c1d1ea934.png" class="img-fluid center" alt="The VS Code extension for Octopus includes OCL syntax highlighting and an OCL tree outline" data-original-src="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/octopus-deploy-vs-code-extension-ocl.png"/></a>T2】</p>

<p><a href="https://marketplace.visualstudio.com/items?itemName=octopusdeploy.vscode-octopusdeploy" rel="nofollow">Octopus Deploy for Visual Studio Code</a>是一个免费的扩展，使得使用Octopus配置语言(OCL)文件更加容易。功能包括:</p>

<ul>
<li>语法突出显示</li>
<li>步骤和操作的代码片段</li>
<li>在文件中导航节点的集成树视图</li>
</ul>

<p>在更新和错误修复之后，我们的VS代码扩展现在已经可以投入生产了。</p>

<p><a href="https://marketplace.visualstudio.com/items?itemName=octopusdeploy.vscode-octopusdeploy" rel="nofollow">安装Octopus Deploy for Visual Studio代码</a>。</p>

<h2 id="terraform-provider-support-for-config-as-code">Terraform Provider支持配置为代码</h2>

<p>我们在2021年初推出了我们的<a href="https://registry.terraform.io/providers/OctopusDeployLabs/octopusdeploy/" rel="nofollow">平台提供商</a>，它越来越受欢迎。我们的提供商有超过400，000次安装，来自Octopus社区的贡献也在增长，用户通过GitHub问题报告错误，并通过pull请求提交更改。</p>

<p>在这个版本中，我们添加了对在HCL中配置版本控制项目的支持。有了对Config as Code的支持，我们添加了Git持久性设置，指定了默认的分支、URL、凭证等等。这允许您在配置Octopus实例时使用Config as代码特性，比如分支。</p>

<p>以下示例突出显示了最新的更新:</p>

<pre><code class="language-json">terraform {
  required_providers {
    octopusdeploy = { ... }
  }
}

resource "octopusdeploy_project_vcs" "test-project-123" {
  name                              = "test-project-name"
  lifecycle_id                      = octopusdeploy_lifecycle.test-lifecycle.id
  project_group_id                  = octopusdeploy_project_group.test-project-group.id
  space_id                          = var.space_id

  git_persistence_settings {
    # base_path
    # default_branch
    url = var.github_url

    credentials {
      password = var.github_pat
      username = var.github_username
    }
  }
}

resource "octopusdeploy_project" "test-project-321" {
  name                              = "test-project-name"
  lifecycle_id                      = octopusdeploy_lifecycle.test-lifecycle.id
  project_group_id                  = octopusdeploy_project_group.test-project-group.id
  space_id                          = var.space_id
}

resource "octopusdeploy_deployment_process" "test-deployment-process-main" {
  branch     = "main"
  project_id = octopusdeploy_project.test-project.id

  step {
    name         = "Hello Main Branch"
    target_roles = ["role 1"]

    run_script_action {
      script_body = "Hello from the main branch!"
      name        = "This is from the action."
    }
  }
}

resource "octopusdeploy_deployment_process" "test-deployment-process-main" {
  branch     = "secondary"
  project_id = octopusdeploy_project.test-project.id

  step {
    name         = "Hello Secondary Branch"
    target_roles = ["role 1"]

    run_script_action {
      script_body = "Hello from a different branch!"
      name        = "This is from the action."
    }
  }
}
</code></pre>

<p><a href="https://registry.terraform.io/providers/OctopusDeployLabs/octopusdeploy/" rel="nofollow">了解关于Octopus Deploy Terraform provider的更多信息</a>。</p>

<h2 id="new-integrations">新集成</h2>

<h3 id="buildkite-plugins-early-access">Buildkite插件(早期访问)</h3>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/buildkite-agent-runs.png" class="zoom" data-title=""><img src="../Images/07ed3d287850833b65edf84a86ad9d33.png" class="img-fluid center" alt=" Buildkite plugin for Octopus Deploy" data-original-src="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/buildkite-agent-runs.png"/>T2】</a></p>

<p>章鱼部署现在与<a href="https://buildkite.com/" rel="nofollow"> Buildkite </a>整合。我们新的Buildkite插件允许您的构建代理创建和部署版本，推送构建信息，并作为管道的一部分运行runbooks。</p>

<p>通过我们的Buildkite插件的集成代表了我们最初的设计和发布。我们计划构建额外的插件，并通过Bash脚本提供集成来消除对Octopus CLI的依赖。</p>

<p><a href="https://octopus.com/blog/introducing-buildkite-integration">了解更多关于我们的Buildkite插件的信息</a>。</p>

<h3 id="no-code-devops-integrations-with-opsera">与Opsera的无代码DevOps集成</h3>

<p>【T2 <img src="../Images/9293a44819d1b19a0bb8263db0661458.png" class="img-fluid center" alt="Opsera and Octopus Configuration" data-original-src="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/opsera-octopus-configuration.png"/></p>

<p>我们与Opsera合作，提供与Octopus Deploy的集成。您可以将Octopus与Opsera支持的95+平台集成，作为其无代码DevOps编排平台的一部分。</p>

<p>自动化您的CI/CD渠道是一项挑战，尤其是在使用不同的解决方案时。Opsera提供自助服务平台，帮助您实现CI/CD渠道的自动化。您可以通过可视化界面来创建具有统一洞察力的声明性管道。</p>

<p>启用后，Opsera的集成通过其管道UI提供对Octopus Deploy中定义的资源的访问，如通道、环境、生命周期、项目、空间和租户。</p>

<p><a href="https://octopus.com/blog/opsera-integration-with-octopus-deploy">阅读我们的公告博客文章</a>以了解关于Opsera与Octopus集成的更多信息。</p>

<p>您还可以通过参加2022年4月12日(星期二)的免费网络研讨会<a href="https://www.opsera.io/events/opsera-and-octopus-integration" rel="nofollow">了解更多信息。</a></p>

<h3 id="connect-octopus-to-all-of-your-azure-devops-organizations">将Octopus连接到您的所有Azure DevOps组织</h3>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/azure-devops-issue-tracker.png" class="zoom" data-title=""><img src="../Images/f18fa6080f1ca6d9c0ef9c6a3a513003.png" class="img-fluid center" alt="screenshot that shows the new UI" data-original-src="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/azure-devops-issue-tracker.png"/>T2】</a></p>

<p>如果您的公司有多个Azure DevOps组织，您现在可以将Octopus连接到所有这些组织。当我们构建将构建信息与包相关联的功能时，我们没有计划让客户访问多个Azure DevOps组织。我们只添加了对关联单个Azure DevOps组织的支持。</p>

<p>在此版本中，我们解决了这一限制，您可以选择配置多个Azure DevOps组织URL。这一更新意味着Octopus可以显示来自多个Azure DevOps组织的工作项，作为发布创建的一部分或在查看包元数据时。</p>

<p>要在Octopus中配置多个URL，请前往<strong>配置➜设置➜ Azure DevOps问题跟踪器</strong>。</p>

<p><a href="https://octopus.com/docs/packaging-applications/build-servers/tfs-azure-devops/using-octopus-extension">了解更多关于使用Octopus扩展的信息</a>。</p>

<h3 id="teamcity-octopus-deploy-integration-update">团队城市八达通部署集成更新</h3>

<p>我们更新了我们的<a href="https://plugins.jetbrains.com/plugin/9038-octopus-deploy-integration" rel="nofollow">团队城市插件</a>，使用最新版本的<a href="https://logging.apache.org/log4j/" rel="nofollow"> Log4j </a>来解决最新的安全漏洞。</p>

<h2 id="automated-step-updates-and-discovery">自动化步骤更新和发现</h2>

<p><a href="#" data-featherlight="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/step-package-updates-and-discovery.png" class="zoom" data-title=""><img src="../Images/d7b2064e5d90543a1272c1d5c151536e.png" class="img-fluid center" alt="Octopus Step Package framework updates and discovery" data-original-src="https://i.octopus.com/blog/2022-03/octopus-release-2022-q1/step-package-updates-and-discovery.png"/>T2】</a></p>

<p>我们一直在悄悄地为构建新的自动化步骤开发下一代框架，我们称之为步骤包框架。我们用新的框架构建了我们的<a href="https://octopus.com/docs/deployments/aws/ecs"> Amazon ECS部署支持</a>，并且我们将继续增强它。</p>

<p>在这个版本中，我们使用我们的新框架为内置步骤引入了一个更新服务。这使得无需升级Octopus服务器或Octopus云实例就能更容易地获得更新和错误修复。Octopus还可以通过这项新服务发现和下载新的步骤。同样，这允许您在不升级Octopus服务器的情况下添加新的Octopus步骤。</p>

<p>上面的屏幕截图显示了一个示例“Hello world”步骤的升级过程。</p>

<h2 id="octopus-deploy-acquired-dist">八达通部署收购区</h2>

<p>Octopus收购了<a href="https://www.dist.cloud/" rel="nofollow"> Dist </a>，这是一个快速可靠的容器和Java工件存储库。Octopus内置了各种包格式的包存储库，但它不支持容器图像。我们正在探索Dist团队的技术和专业知识如何帮助我们为低延迟、安全和集成的容器注册添加这一功能。</p>

<p><a href="https://octopus.com/blog/octopus-acquires-dist">在Paul Stovell的博客文章</a>中了解更多信息。</p>

<h2 id="breaking-changes">重大变化</h2>

<p>此版本包含一个突破性的变化:</p>

<p><strong>配置为代码API URLs重命名</strong></p>

<p>我们对相关链接集合中的一些Config as Code API URLs和key做了一些小的修改。这些更改只会影响受版本控制的项目，并且只有在您直接使用URL时才会引起问题。</p>

<p>在<a href="https://github.com/OctopusDeploy/Issues/issues/7376" rel="nofollow"> GitHub问题</a>中了解更多关于这一变化的信息。</p>

<h2 id="upgrade-or-get-started">升级或开始</h2>

<p>章鱼云用户已经在运行这个版本了。自托管八达通客户可以从我们的网站下载最新版本。</p>

<p><span> <a class="btn btn-success" href="https://octopus.com/downloads/">下载章鱼2022.1 </a> </span></p>

<p>我们鼓励你回顾一下升级Octopus服务器的<a href="https://octopus.com/docs/administration/upgrading">步骤。更多信息请参见</a><a href="https://octopus.com/downloads/whatsnew/2022.1">发行说明</a>。</p>

<p>如果你以前从未使用过Octopus，<a href="https://octopus.com/start">注册</a>免费试用，或者<a href="mailto:sales@octopus.com" rel="nofollow">给我们的销售团队</a>发电子邮件观看演示并了解更多信息。</p>

<h2 id="whats-coming-in-future-releases">未来的版本中会有什么？</h2>

<p>查看我们的<a href="https://octopus.com/roadmap">公共路线图</a>以了解最新消息并注册更新。</p>

<h2 id="conclusion">结论</h2>

<p>Octopus 2022 Q1提供了Octopus中Config as代码的第一个里程碑，以及我们的Visual Studio代码插件的生产就绪版本，具有OCL突出显示、代码片段和导航树。这个版本还包括大量新的和更新的集成。</p>

<p>我们期待看到我们的客户使用版本控制项目。我们将继续向我们的配置代码解决方案添加更多功能。</p>

<p>我们欢迎您提出任何问题或意见。你可以在下面留下反馈，或者加入我们的<a href="https://octopus.com/slack">章鱼社区Slack </a>的讨论。</p>

<p>我们还邀请您观看我们的<a href="https://octopus.com/events/introducing-config-as-code-in-octopus">免费网络研讨会，介绍Octopus </a>中作为代码的配置。</p>

<p>愉快的(版本控制的)部署！</p>

                    
                    
</body>
</html>